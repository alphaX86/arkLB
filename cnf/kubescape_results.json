{"name":"NSA","controlReports":[{"guid":"","id":"C-0057","controlID":"C-0057","name":"Privileged container","ruleReports":[{"name":"rule-privilege-escalation","remediation":"","ruleStatus":{"status":"success","message":""},"ruleResponses":[{"alertMessage":"","failedPaths":["spec.template.spec.containers[0].securityContext.privileged"],"fixPaths":null,"ruleStatus":"failed","packagename":"","alertScore":0,"alertObject":{"k8sApiObjects":[{"apiVersion":"apps/v1","kind":"Deployment","metadata":{"annotations":{"deployment.kubernetes.io/revision":"3","litmuschaos.io/chaos":"true","meta.helm.sh/release-name":"arklb","meta.helm.sh/release-namespace":"ark-cnf"},"creationTimestamp":"2023-05-27T11:58:34Z","generation":8,"labels":{"app.kubernetes.io/instance":"arklb","app.kubernetes.io/managed-by":"Helm","app.kubernetes.io/name":"arklb","app.kubernetes.io/version":"v0.1.10","helm.sh/chart":"arklb-0.1.11"},"name":"arklb","namespace":"ark-cnf","resourceVersion":"2260893","uid":"cc4b4ff4-8e89-475f-beb8-0a715c1fcac1"}}]},"rulename":"rule-privilege-escalation"}],"listInputIDs":["apps/v1/ark-cnf/Deployment/arklb","apps/v1/gmp-system/Deployment/rule-evaluator","apps/v1/kubernetes-dashboard/Deployment/kubernetes-dashboard","apps/v1/gmp-system/Deployment/gmp-operator","apps/v1/kubernetes-dashboard/Deployment/dashboard-metrics-scraper","apps/v1/gmp-system/StatefulSet/alertmanager","apps/v1/gmp-system/DaemonSet/collector"],"totalResources":7,"failedResources":1,"warningResources":0}],"remediation":"Remove privileged capabilities by setting the securityContext.privileged to false. If you must deploy a Pod as privileged, add other restriction to it, such as network policy, Seccomp etc and still remove all unnecessary capabilities. Use the exception mechanism to remove unnecessary notifications.","description":"Potential attackers may gain access to privileged containers and inherit access to the host resources. Therefore, it is not recommended to deploy privileged containers unless it is absolutely necessary. This control identifies all the privileged Pods.","score":14.285714,"baseScore":8,"totalResources":7,"failedResources":1,"warningResources":0},{"guid":"","id":"C-0006","controlID":"C-0006","name":"Allowed hostPath","ruleReports":[{"name":"alert-rw-hostpath","remediation":"","ruleStatus":{"status":"success","message":""},"ruleResponses":null,"listInputIDs":["apps/v1/gmp-system/Deployment/gmp-operator","apps/v1/gmp-system/StatefulSet/alertmanager","apps/v1/ark-cnf/Deployment/arklb","apps/v1/gmp-system/DaemonSet/collector","apps/v1/gmp-system/Deployment/rule-evaluator","apps/v1/kubernetes-dashboard/Deployment/dashboard-metrics-scraper","apps/v1/kubernetes-dashboard/Deployment/kubernetes-dashboard"],"totalResources":7,"failedResources":0,"warningResources":0}],"remediation":"Refrain from using host path mount.","description":"Mounting host directory to the container can be abused to get access to sensitive data and gain persistence on the host machine.","score":0,"baseScore":6,"totalResources":7,"failedResources":0,"warningResources":0},{"guid":"","id":"C-0034","controlID":"C-0034","name":"Automatic mapping of service account","ruleReports":[{"name":"automount-service-account","remediation":"","ruleStatus":{"status":"success","message":""},"ruleResponses":[{"alertMessage":"","failedPaths":["spec.template.spec.automountServiceAccountToken"],"fixPaths":null,"ruleStatus":"failed","packagename":"","alertScore":0,"alertObject":{"k8sApiObjects":[{"apiVersion":"apps/v1","kind":"Deployment","metadata":{"annotations":{"components.gke.io/layer":"addon","deployment.kubernetes.io/revision":"3"},"creationTimestamp":"2023-05-25T09:54:08Z","generation":3,"labels":{"addonmanager.kubernetes.io/mode":"Reconcile"},"name":"rule-evaluator","namespace":"gmp-system","resourceVersion":"1607906","uid":"914f272c-aa43-451d-aed1-f0f1a67122f0"}}]},"rulename":"automount-service-account"},{"alertMessage":"","failedPaths":null,"fixPaths":[{"path":"automountServiceAccountToken","value":"false"}],"ruleStatus":"failed","packagename":"","alertScore":0,"alertObject":{"k8sApiObjects":[{"apiVersion":"v1","kind":"ServiceAccount","metadata":{"annotations":{},"creationTimestamp":"2023-05-27T12:04:57Z","labels":{"app.kubernetes.io/part-of":"litmus","name":"node-drain-sa"},"name":"node-drain-sa","namespace":"ark-cnf","resourceVersion":"2260889","uid":"205c5af1-6a4e-434d-81da-e3f421d2f655"}}]},"rulename":"automount-service-account"},{"alertMessage":"","failedPaths":null,"fixPaths":[{"path":"automountServiceAccountToken","value":"false"}],"ruleStatus":"failed","packagename":"","alertScore":0,"alertObject":{"k8sApiObjects":[{"apiVersion":"v1","kind":"ServiceAccount","metadata":{"creationTimestamp":"2023-05-25T09:54:02Z","name":"default","namespace":"gmp-public","resourceVersion":"605806","uid":"b2719fec-1488-4edf-a80e-a3242433e99e"}}]},"rulename":"automount-service-account"},{"alertMessage":"","failedPaths":null,"fixPaths":[{"path":"automountServiceAccountToken","value":"false"}],"ruleStatus":"failed","packagename":"","alertScore":0,"alertObject":{"k8sApiObjects":[{"apiVersion":"v1","kind":"ServiceAccount","metadata":{"annotations":{"components.gke.io/layer":"addon"},"creationTimestamp":"2023-05-25T09:54:02Z","labels":{"addonmanager.kubernetes.io/mode":"Reconcile"},"name":"operator","namespace":"gmp-system","resourceVersion":"605815","uid":"a831ed12-659d-4ab3-bd5a-3709c8fceef5"}}]},"rulename":"automount-service-account"},{"alertMessage":"","failedPaths":null,"fixPaths":[{"path":"spec.template.spec.automountServiceAccountToken","value":"false"}],"ruleStatus":"failed","packagename":"","alertScore":0,"alertObject":{"k8sApiObjects":[{"apiVersion":"apps/v1","kind":"StatefulSet","metadata":{"annotations":{"components.gke.io/layer":"addon"},"creationTimestamp":"2023-05-25T09:54:09Z","generation":2,"labels":{"addonmanager.kubernetes.io/mode":"Reconcile"},"name":"alertmanager","namespace":"gmp-system","resourceVersion":"1607794","uid":"e66b74b2-05fb-4f4c-a2f4-f9a234365c64"}}]},"rulename":"automount-service-account"},{"alertMessage":"","failedPaths":null,"fixPaths":[{"path":"automountServiceAccountToken","value":"false"}],"ruleStatus":"failed","packagename":"","alertScore":0,"alertObject":{"k8sApiObjects":[{"apiVersion":"v1","kind":"ServiceAccount","metadata":{"creationTimestamp":"2023-05-26T15:05:41Z","name":"default","namespace":"kubernetes-dashboard","resourceVersion":"1615369","uid":"f1115d4b-b754-4253-aa3f-c0a1d88a3d97"}}]},"rulename":"automount-service-account"},{"alertMessage":"","failedPaths":null,"fixPaths":[{"path":"automountServiceAccountToken","value":"false"}],"ruleStatus":"failed","packagename":"","alertScore":0,"alertObject":{"k8sApiObjects":[{"apiVersion":"v1","kind":"ServiceAccount","metadata":{"annotations":{"components.gke.io/layer":"addon"},"creationTimestamp":"2023-05-25T09:54:02Z","labels":{"addonmanager.kubernetes.io/mode":"Reconcile"},"name":"collector","namespace":"gmp-system","resourceVersion":"605812","uid":"d3932ff9-b688-4b97-b664-8a26acf2b508"}}]},"rulename":"automount-service-account"},{"alertMessage":"","failedPaths":["spec.template.spec.automountServiceAccountToken"],"fixPaths":null,"ruleStatus":"failed","packagename":"","alertScore":0,"alertObject":{"k8sApiObjects":[{"apiVersion":"apps/v1","kind":"Deployment","metadata":{"annotations":{"components.gke.io/layer":"addon","deployment.kubernetes.io/revision":"3"},"creationTimestamp":"2023-05-25T09:54:04Z","generation":3,"labels":{"addonmanager.kubernetes.io/mode":"Reconcile","app":"managed-prometheus-operator","app.kubernetes.io/component":"operator","app.kubernetes.io/name":"gmp-operator","app.kubernetes.io/part-of":"gmp"},"name":"gmp-operator","namespace":"gmp-system","resourceVersion":"1607645","uid":"7aba6022-9924-4e8d-968d-e5b8cd22b059"}}]},"rulename":"automount-service-account"},{"alertMessage":"","failedPaths":["spec.template.spec.automountServiceAccountToken"],"fixPaths":null,"ruleStatus":"failed","packagename":"","alertScore":0,"alertObject":{"k8sApiObjects":[{"apiVersion":"apps/v1","kind":"DaemonSet","metadata":{"annotations":{"components.gke.io/layer":"addon","deprecated.daemonset.template.generation":"3"},"creationTimestamp":"2023-05-25T09:54:08Z","generation":3,"labels":{"addonmanager.kubernetes.io/mode":"Reconcile"},"name":"collector","namespace":"gmp-system","resourceVersion":"1612265","uid":"c9eacc38-ca9b-4a5a-8bad-3e4d6d5372a2"}}]},"rulename":"automount-service-account"},{"alertMessage":"","failedPaths":null,"fixPaths":[{"path":"automountServiceAccountToken","value":"false"}],"ruleStatus":"excluded","packagename":"","alertScore":0,"alertObject":{"k8sApiObjects":[{"apiVersion":"v1","kind":"ServiceAccount","metadata":{"creationTimestamp":"2023-05-24T16:39:59Z","name":"default","namespace":"default","resourceVersion":"269","uid":"884e52bf-4b0c-4f1b-90c4-ed6649596d07"}}]},"rulename":"automount-service-account","exception":{"guid":"","name":"exclude-default-namespace-resources-3","attributes":{"systemException":true},"policyType":"postureExceptionPolicy","creationTime":"","actions":["alertOnly"],"resources":[{"designatorType":"Attributes","attributes":{"kind":"ServiceAccount","name":"default","namespace":"default"}}],"posturePolicies":[{"frameworkName":""}]}},{"alertMessage":"","failedPaths":null,"fixPaths":[{"path":"automountServiceAccountToken","value":"false"}],"ruleStatus":"failed","packagename":"","alertScore":0,"alertObject":{"k8sApiObjects":[{"apiVersion":"v1","kind":"ServiceAccount","metadata":{"annotations":{},"creationTimestamp":"2023-05-26T15:05:41Z","labels":{"k8s-app":"kubernetes-dashboard"},"name":"kubernetes-dashboard","namespace":"kubernetes-dashboard","resourceVersion":"1615372","uid":"0488a1c5-96d5-4d24-95cc-d7813cf7def5"}}]},"rulename":"automount-service-account"},{"alertMessage":"","failedPaths":null,"fixPaths":[{"path":"spec.template.spec.automountServiceAccountToken","value":"false"}],"ruleStatus":"failed","packagename":"","alertScore":0,"alertObject":{"k8sApiObjects":[{"apiVersion":"apps/v1","kind":"Deployment","metadata":{"annotations":{"deployment.kubernetes.io/revision":"1"},"creationTimestamp":"2023-05-26T15:05:43Z","generation":1,"labels":{"k8s-app":"kubernetes-dashboard"},"name":"kubernetes-dashboard","namespace":"kubernetes-dashboard","resourceVersion":"1616115","uid":"f9cf23dc-f9bf-406f-9a85-913be6f490d2"}}]},"rulename":"automount-service-account"},{"alertMessage":"","failedPaths":null,"fixPaths":[{"path":"spec.template.spec.automountServiceAccountToken","value":"false"}],"ruleStatus":"failed","packagename":"","alertScore":0,"alertObject":{"k8sApiObjects":[{"apiVersion":"apps/v1","kind":"Deployment","metadata":{"annotations":{"deployment.kubernetes.io/revision":"1"},"creationTimestamp":"2023-05-26T15:05:43Z","generation":1,"labels":{"k8s-app":"dashboard-metrics-scraper"},"name":"dashboard-metrics-scraper","namespace":"kubernetes-dashboard","resourceVersion":"2261246","uid":"63c8492b-c4e8-4b20-a6fb-6e45d5defe22"}}]},"rulename":"automount-service-account"},{"alertMessage":"","failedPaths":null,"fixPaths":[{"path":"automountServiceAccountToken","value":"false"}],"ruleStatus":"failed","packagename":"","alertScore":0,"alertObject":{"k8sApiObjects":[{"apiVersion":"v1","kind":"ServiceAccount","metadata":{"creationTimestamp":"2023-05-27T11:27:52Z","name":"default","namespace":"ark-cnf","resourceVersion":"2239796","uid":"023f26df-8c55-4366-ac74-06fcc1ae9d92"}}]},"rulename":"automount-service-account"},{"alertMessage":"","failedPaths":null,"fixPaths":[{"path":"automountServiceAccountToken","value":"false"}],"ruleStatus":"failed","packagename":"","alertScore":0,"alertObject":{"k8sApiObjects":[{"apiVersion":"v1","kind":"ServiceAccount","metadata":{"creationTimestamp":"2023-05-25T09:54:01Z","name":"default","namespace":"gmp-system","resourceVersion":"605798","uid":"581a4dcb-5b10-439f-bd82-5f016367b00e"}}]},"rulename":"automount-service-account"},{"alertMessage":"","failedPaths":null,"fixPaths":[{"path":"spec.template.spec.automountServiceAccountToken","value":"false"}],"ruleStatus":"failed","packagename":"","alertScore":0,"alertObject":{"k8sApiObjects":[{"apiVersion":"apps/v1","kind":"Deployment","metadata":{"annotations":{"deployment.kubernetes.io/revision":"3","litmuschaos.io/chaos":"true","meta.helm.sh/release-name":"arklb","meta.helm.sh/release-namespace":"ark-cnf"},"creationTimestamp":"2023-05-27T11:58:34Z","generation":8,"labels":{"app.kubernetes.io/instance":"arklb","app.kubernetes.io/managed-by":"Helm","app.kubernetes.io/name":"arklb","app.kubernetes.io/version":"v0.1.10","helm.sh/chart":"arklb-0.1.11"},"name":"arklb","namespace":"ark-cnf","resourceVersion":"2260893","uid":"cc4b4ff4-8e89-475f-beb8-0a715c1fcac1"}}]},"rulename":"automount-service-account"},{"alertMessage":"","failedPaths":null,"fixPaths":[{"path":"automountServiceAccountToken","value":"false"}],"ruleStatus":"failed","packagename":"","alertScore":0,"alertObject":{"k8sApiObjects":[{"apiVersion":"v1","kind":"ServiceAccount","metadata":{"annotations":{"meta.helm.sh/release-name":"arklb","meta.helm.sh/release-namespace":"ark-cnf"},"creationTimestamp":"2023-05-27T11:58:33Z","labels":{"app.kubernetes.io/instance":"arklb","app.kubernetes.io/managed-by":"Helm","app.kubernetes.io/name":"arklb","app.kubernetes.io/version":"v0.1.10","helm.sh/chart":"arklb-0.1.11"},"name":"arklb","namespace":"ark-cnf","resourceVersion":"2257020","uid":"846a5ad2-f2eb-4992-a8b2-ce79384569bc"}}]},"rulename":"automount-service-account"}],"listInputIDs":["apps/v1/gmp-system/Deployment/rule-evaluator","/v1/ark-cnf/ServiceAccount/node-drain-sa","/v1/gmp-public/ServiceAccount/default","/v1/gmp-system/ServiceAccount/operator","apps/v1/gmp-system/StatefulSet/alertmanager","/v1/kubernetes-dashboard/ServiceAccount/default","/v1/gmp-system/ServiceAccount/collector","apps/v1/gmp-system/Deployment/gmp-operator","apps/v1/gmp-system/DaemonSet/collector","/v1/default/ServiceAccount/default","/v1/kubernetes-dashboard/ServiceAccount/kubernetes-dashboard","apps/v1/kubernetes-dashboard/Deployment/kubernetes-dashboard","apps/v1/kubernetes-dashboard/Deployment/dashboard-metrics-scraper","/v1/ark-cnf/ServiceAccount/default","/v1/gmp-system/ServiceAccount/default","apps/v1/ark-cnf/Deployment/arklb","/v1/ark-cnf/ServiceAccount/arklb"],"totalResources":17,"failedResources":16,"warningResources":1}],"remediation":"Disable automatic mounting of service account tokens to PODs either at the service account level or at the individual POD level, by specifying the automountServiceAccountToken: false. Note that POD level takes precedence.","description":"Potential attacker may gain access to a POD and steal its service account token. Therefore, it is recommended to disable automatic mapping of the service account tokens in service account configuration and enable it only for PODs that need to use them.","score":94.117645,"baseScore":5,"totalResources":17,"failedResources":16,"warningResources":1},{"guid":"","id":"C-0059","controlID":"C-0059","name":"CVE-2021-25742-nginx-ingress-snippet-annotation-vulnerability","ruleReports":[],"remediation":"To mitigate this vulnerability: 1. Upgrade to a version that allows mitigation (\u003e= v0.49.1 or \u003e= v1.0.1), 2. Set allow-snippet-annotations to false in your ingress-nginx ConfigMap based on how you deploy ingress-nginx","description":"Security issue in ingress-nginx where a user that can create or update ingress objects can use the custom snippets feature to obtain all secrets in the cluster (see more at https://github.com/kubernetes/ingress-nginx/issues/7837)","score":0,"baseScore":5,"totalResources":0,"failedResources":0,"warningResources":0},{"guid":"","id":"C-0068","controlID":"C-0068","name":"PSP enabled","ruleReports":[],"remediation":"Turn Pod Security Policies on in your cluster, if you use other admission controllers to control the behavior that PSP controls, exclude this control from your scans","description":"PSP enable fine-grained authorization of pod creation and it is important to enable it","score":0,"baseScore":3,"totalResources":0,"failedResources":0,"warningResources":0},{"guid":"","id":"C-0069","controlID":"C-0069","name":"Disable anonymous access to Kubelet service","ruleReports":[],"remediation":"Start the kubelet with the --anonymous-auth=false flag.","description":"By default, requests to the kubelet's HTTPS endpoint that are not rejected by other configured authentication methods are treated as anonymous requests, and given a username of system:anonymous and a group of system:unauthenticated.","score":0,"baseScore":10,"totalResources":0,"failedResources":0,"warningResources":0},{"guid":"","id":"C-0058","controlID":"C-0058","name":"CVE-2021-25741 - Using symlink for arbitrary host file system access.","ruleReports":[],"remediation":"To mitigate this vulnerability without upgrading kubelet, you can disable the VolumeSubpath feature gate on kubelet and kube-apiserver, or remove any existing Pods using subPath or subPathExpr feature.","description":"A user may be able to create a container with subPath or subPathExpr volume mounts to access files \u0026 directories anywhere on the host filesystem. Following Kubernetes versions are affected: v1.22.0 - v1.22.1, v1.21.0 - v1.21.4, v1.20.0 - v1.20.10, version v1.19.14 and lower. This control checks the vulnerable versions and the actual usage of the subPath feature in all Pods in the cluster. If you want to learn more about the CVE, please refer to the CVE link: https://nvd.nist.gov/vuln/detail/CVE-2021-25741","score":0,"baseScore":6,"totalResources":0,"failedResources":0,"warningResources":0},{"guid":"","id":"C-0070","controlID":"C-0070","name":"Enforce Kubelet client TLS authentication","ruleReports":[],"remediation":"Start the kubelet with the --client-ca-file flag, providing a CA bundle to verify client certificates with.","description":"Kubelets are the node level orchestrator in Kubernetes control plane. They are publishing service port 10250 where they accept commands from API server. Operator must make sure that only API server is allowed to submit commands to Kubelet. This is done through client certificate verification, must configure Kubelet with client CA file to use for this purpose.","score":0,"baseScore":10,"totalResources":0,"failedResources":0,"warningResources":0},{"guid":"","id":"C-0013","controlID":"C-0013","name":"Non-root containers","ruleReports":[{"name":"non-root-containers","remediation":"","ruleStatus":{"status":"success","message":""},"ruleResponses":[{"alertMessage":"","failedPaths":null,"fixPaths":[{"path":"spec.template.spec.securityContext.runAsNonRoot","value":"true"},{"path":"spec.template.spec.securityContext.allowPrivilegeEscalation","value":"false"}],"ruleStatus":"failed","packagename":"","alertScore":0,"alertObject":{"k8sApiObjects":[{"apiVersion":"apps/v1","kind":"Deployment","metadata":{"annotations":{"deployment.kubernetes.io/revision":"3","litmuschaos.io/chaos":"true","meta.helm.sh/release-name":"arklb","meta.helm.sh/release-namespace":"ark-cnf"},"creationTimestamp":"2023-05-27T11:58:34Z","generation":8,"labels":{"app.kubernetes.io/instance":"arklb","app.kubernetes.io/managed-by":"Helm","app.kubernetes.io/name":"arklb","app.kubernetes.io/version":"v0.1.10","helm.sh/chart":"arklb-0.1.11"},"name":"arklb","namespace":"ark-cnf","resourceVersion":"2260893","uid":"cc4b4ff4-8e89-475f-beb8-0a715c1fcac1"}}]},"rulename":"non-root-containers"}],"listInputIDs":["apps/v1/gmp-system/Deployment/rule-evaluator","apps/v1/gmp-system/Deployment/gmp-operator","apps/v1/kubernetes-dashboard/Deployment/dashboard-metrics-scraper","apps/v1/ark-cnf/Deployment/arklb","apps/v1/kubernetes-dashboard/Deployment/kubernetes-dashboard","apps/v1/gmp-system/DaemonSet/collector","apps/v1/gmp-system/StatefulSet/alertmanager"],"totalResources":7,"failedResources":1,"warningResources":0}],"remediation":"If your application does not need root privileges, make sure to define the runAsUser or runAsGroup under the PodSecurityContext and use user ID 1000 or higher. Do not turn on allowPrivlegeEscalation bit and make sure runAsNonRoot is true.","description":"Potential attackers may gain access to a container and leverage its existing privileges to conduct an attack. Therefore, it is not recommended to deploy containers with root privileges unless it is absolutely necessary. This control identifies all the Pods running as root or can escalate to root.","score":14.285714,"baseScore":6,"totalResources":7,"failedResources":1,"warningResources":0},{"guid":"","id":"C-0041","controlID":"C-0041","name":"HostNetwork access","ruleReports":[{"name":"host-network-access","remediation":"","ruleStatus":{"status":"success","message":""},"ruleResponses":null,"listInputIDs":["apps/v1/gmp-system/StatefulSet/alertmanager","apps/v1/gmp-system/DaemonSet/collector","apps/v1/kubernetes-dashboard/Deployment/kubernetes-dashboard","apps/v1/gmp-system/Deployment/rule-evaluator","apps/v1/gmp-system/Deployment/gmp-operator","apps/v1/kubernetes-dashboard/Deployment/dashboard-metrics-scraper","apps/v1/ark-cnf/Deployment/arklb"],"totalResources":7,"failedResources":0,"warningResources":0}],"remediation":"Only connect PODs to host network when it is necessary. If not, set the hostNetwork field of the pod spec to false, or completely remove it (false is the default). Whitelist only those PODs that must have access to host network by design.","description":"Potential attackers may gain access to a POD and inherit access to the entire host network. For example, in AWS case, they will have access to the entire VPC. This control identifies all the PODs with host network access enabled.","score":0,"baseScore":5,"totalResources":7,"failedResources":0,"warningResources":0},{"guid":"","id":"C-0009","controlID":"C-0009","name":"Resource policies","ruleReports":[{"name":"resource-policies","remediation":"","ruleStatus":{"status":"success","message":""},"ruleResponses":[{"alertMessage":"","failedPaths":null,"fixPaths":[{"path":"spec.template.spec.containers[0].resources.limits.cpu","value":"YOUR_VALUE"},{"path":"spec.template.spec.containers[0].resources.limits.memory","value":"YOUR_VALUE"}],"ruleStatus":"failed","packagename":"","alertScore":0,"alertObject":{"k8sApiObjects":[{"apiVersion":"apps/v1","kind":"Deployment","metadata":{"annotations":{"deployment.kubernetes.io/revision":"1"},"creationTimestamp":"2023-05-26T15:05:43Z","generation":1,"labels":{"k8s-app":"kubernetes-dashboard"},"name":"kubernetes-dashboard","namespace":"kubernetes-dashboard","resourceVersion":"1616115","uid":"f9cf23dc-f9bf-406f-9a85-913be6f490d2"}}]},"rulename":"resource-policies"},{"alertMessage":"","failedPaths":null,"fixPaths":[{"path":"spec.template.spec.containers[0].resources.limits.cpu","value":"YOUR_VALUE"},{"path":"spec.template.spec.containers[0].resources.limits.memory","value":"YOUR_VALUE"}],"ruleStatus":"failed","packagename":"","alertScore":0,"alertObject":{"k8sApiObjects":[{"apiVersion":"apps/v1","kind":"Deployment","metadata":{"annotations":{"deployment.kubernetes.io/revision":"3","litmuschaos.io/chaos":"true","meta.helm.sh/release-name":"arklb","meta.helm.sh/release-namespace":"ark-cnf"},"creationTimestamp":"2023-05-27T11:58:34Z","generation":8,"labels":{"app.kubernetes.io/instance":"arklb","app.kubernetes.io/managed-by":"Helm","app.kubernetes.io/name":"arklb","app.kubernetes.io/version":"v0.1.10","helm.sh/chart":"arklb-0.1.11"},"name":"arklb","namespace":"ark-cnf","resourceVersion":"2260893","uid":"cc4b4ff4-8e89-475f-beb8-0a715c1fcac1"}}]},"rulename":"resource-policies"},{"alertMessage":"","failedPaths":null,"fixPaths":[{"path":"spec.template.spec.containers[0].resources.limits.cpu","value":"YOUR_VALUE"},{"path":"spec.template.spec.containers[0].resources.limits.memory","value":"YOUR_VALUE"}],"ruleStatus":"failed","packagename":"","alertScore":0,"alertObject":{"k8sApiObjects":[{"apiVersion":"apps/v1","kind":"Deployment","metadata":{"annotations":{"deployment.kubernetes.io/revision":"1"},"creationTimestamp":"2023-05-26T15:05:43Z","generation":1,"labels":{"k8s-app":"dashboard-metrics-scraper"},"name":"dashboard-metrics-scraper","namespace":"kubernetes-dashboard","resourceVersion":"2261246","uid":"63c8492b-c4e8-4b20-a6fb-6e45d5defe22"}}]},"rulename":"resource-policies"},{"alertMessage":"","failedPaths":null,"fixPaths":[{"path":"spec.template.spec.containers[0].resources.limits.cpu","value":"YOUR_VALUE"},{"path":"spec.template.spec.containers[1].resources.limits.cpu","value":"YOUR_VALUE"}],"ruleStatus":"failed","packagename":"","alertScore":0,"alertObject":{"k8sApiObjects":[{"apiVersion":"apps/v1","kind":"Deployment","metadata":{"annotations":{"components.gke.io/layer":"addon","deployment.kubernetes.io/revision":"3"},"creationTimestamp":"2023-05-25T09:54:08Z","generation":3,"labels":{"addonmanager.kubernetes.io/mode":"Reconcile"},"name":"rule-evaluator","namespace":"gmp-system","resourceVersion":"1607906","uid":"914f272c-aa43-451d-aed1-f0f1a67122f0"}}]},"rulename":"resource-policies"},{"alertMessage":"","failedPaths":null,"fixPaths":[{"path":"spec.template.spec.containers[0].resources.limits.cpu","value":"YOUR_VALUE"},{"path":"spec.template.spec.containers[1].resources.limits.cpu","value":"YOUR_VALUE"}],"ruleStatus":"failed","packagename":"","alertScore":0,"alertObject":{"k8sApiObjects":[{"apiVersion":"apps/v1","kind":"StatefulSet","metadata":{"annotations":{"components.gke.io/layer":"addon"},"creationTimestamp":"2023-05-25T09:54:09Z","generation":2,"labels":{"addonmanager.kubernetes.io/mode":"Reconcile"},"name":"alertmanager","namespace":"gmp-system","resourceVersion":"1607794","uid":"e66b74b2-05fb-4f4c-a2f4-f9a234365c64"}}]},"rulename":"resource-policies"},{"alertMessage":"","failedPaths":null,"fixPaths":[{"path":"spec.template.spec.containers[0].resources.limits.cpu","value":"YOUR_VALUE"},{"path":"spec.template.spec.containers[1].resources.limits.cpu","value":"YOUR_VALUE"}],"ruleStatus":"failed","packagename":"","alertScore":0,"alertObject":{"k8sApiObjects":[{"apiVersion":"apps/v1","kind":"DaemonSet","metadata":{"annotations":{"components.gke.io/layer":"addon","deprecated.daemonset.template.generation":"3"},"creationTimestamp":"2023-05-25T09:54:08Z","generation":3,"labels":{"addonmanager.kubernetes.io/mode":"Reconcile"},"name":"collector","namespace":"gmp-system","resourceVersion":"1612265","uid":"c9eacc38-ca9b-4a5a-8bad-3e4d6d5372a2"}}]},"rulename":"resource-policies"},{"alertMessage":"","failedPaths":null,"fixPaths":[{"path":"spec.template.spec.containers[0].resources.limits.cpu","value":"YOUR_VALUE"}],"ruleStatus":"failed","packagename":"","alertScore":0,"alertObject":{"k8sApiObjects":[{"apiVersion":"apps/v1","kind":"Deployment","metadata":{"annotations":{"components.gke.io/layer":"addon","deployment.kubernetes.io/revision":"3"},"creationTimestamp":"2023-05-25T09:54:04Z","generation":3,"labels":{"addonmanager.kubernetes.io/mode":"Reconcile","app":"managed-prometheus-operator","app.kubernetes.io/component":"operator","app.kubernetes.io/name":"gmp-operator","app.kubernetes.io/part-of":"gmp"},"name":"gmp-operator","namespace":"gmp-system","resourceVersion":"1607645","uid":"7aba6022-9924-4e8d-968d-e5b8cd22b059"}}]},"rulename":"resource-policies"}],"listInputIDs":["apps/v1/kubernetes-dashboard/Deployment/kubernetes-dashboard","apps/v1/ark-cnf/Deployment/arklb","apps/v1/kubernetes-dashboard/Deployment/dashboard-metrics-scraper","apps/v1/gmp-system/Deployment/rule-evaluator","apps/v1/gmp-system/StatefulSet/alertmanager","apps/v1/gmp-system/DaemonSet/collector","apps/v1/gmp-system/Deployment/gmp-operator"],"totalResources":7,"failedResources":7,"warningResources":0}],"remediation":"Define LimitRange and Resource Limits in the namespace or in the deployment/POD yamls.","description":"CPU and memory resources should have a limit set for every container or a namespace to prevent resource exhaustion. This control identifies all the Pods without resource limit definitions by checking their yaml definition file as well as their namespace LimitRange objects. It is also recommended to use ResourceQuota object to restrict overall namespace resources, but this is not verified by this control.","score":100,"baseScore":2,"totalResources":7,"failedResources":7,"warningResources":0},{"guid":"","id":"C-0047","controlID":"C-0047","name":"Exposed dashboard","ruleReports":[],"remediation":"Update dashboard version to v2.0.1 and above.","description":"Kubernetes dashboard versions before v2.0.1 do not support user authentication. If exposed externally, it will allow unauthenticated remote management of the cluster. This control checks presence of the kubernetes-dashboard deployment and its version number.","score":0,"baseScore":6,"totalResources":0,"failedResources":0,"warningResources":0},{"guid":"","id":"C-0016","controlID":"C-0016","name":"Allow privilege escalation","ruleReports":[{"name":"rule-allow-privilege-escalation","remediation":"","ruleStatus":{"status":"success","message":""},"ruleResponses":[{"alertMessage":"","failedPaths":null,"fixPaths":[{"path":"spec.template.spec.containers[0].securityContext.allowPrivilegeEscalation","value":"false"}],"ruleStatus":"failed","packagename":"","alertScore":0,"alertObject":{"k8sApiObjects":[{"apiVersion":"apps/v1","kind":"Deployment","metadata":{"annotations":{"deployment.kubernetes.io/revision":"3","litmuschaos.io/chaos":"true","meta.helm.sh/release-name":"arklb","meta.helm.sh/release-namespace":"ark-cnf"},"creationTimestamp":"2023-05-27T11:58:34Z","generation":8,"labels":{"app.kubernetes.io/instance":"arklb","app.kubernetes.io/managed-by":"Helm","app.kubernetes.io/name":"arklb","app.kubernetes.io/version":"v0.1.10","helm.sh/chart":"arklb-0.1.11"},"name":"arklb","namespace":"ark-cnf","resourceVersion":"2260893","uid":"cc4b4ff4-8e89-475f-beb8-0a715c1fcac1"}}]},"rulename":"rule-allow-privilege-escalation"}],"listInputIDs":["apps/v1/ark-cnf/Deployment/arklb","apps/v1/gmp-system/Deployment/gmp-operator","apps/v1/gmp-system/StatefulSet/alertmanager","apps/v1/gmp-system/DaemonSet/collector","apps/v1/gmp-system/Deployment/rule-evaluator","apps/v1/kubernetes-dashboard/Deployment/dashboard-metrics-scraper","apps/v1/kubernetes-dashboard/Deployment/kubernetes-dashboard"],"totalResources":7,"failedResources":1,"warningResources":0}],"remediation":"If your application does not need it, make sure the allowPrivilegeEscalation field of the securityContext is set to false.","description":"Attackers may gain access to a container and uplift its privilege to enable excessive capabilities.","score":14.285714,"baseScore":6,"totalResources":7,"failedResources":1,"warningResources":0},{"guid":"","id":"C-0030","controlID":"C-0030","name":"Ingress and Egress blocked","ruleReports":[{"name":"ingress-and-egress-blocked","remediation":"","ruleStatus":{"status":"success","message":""},"ruleResponses":[{"alertMessage":"","failedPaths":null,"fixPaths":null,"ruleStatus":"failed","packagename":"","alertScore":0,"alertObject":{"k8sApiObjects":[{"apiVersion":"apps/v1","kind":"Deployment","metadata":{"annotations":{"components.gke.io/layer":"addon","deployment.kubernetes.io/revision":"3"},"creationTimestamp":"2023-05-25T09:54:04Z","generation":3,"labels":{"addonmanager.kubernetes.io/mode":"Reconcile","app":"managed-prometheus-operator","app.kubernetes.io/component":"operator","app.kubernetes.io/name":"gmp-operator","app.kubernetes.io/part-of":"gmp"},"name":"gmp-operator","namespace":"gmp-system","resourceVersion":"1607645","uid":"7aba6022-9924-4e8d-968d-e5b8cd22b059"}}]},"rulename":"ingress-and-egress-blocked"},{"alertMessage":"","failedPaths":null,"fixPaths":null,"ruleStatus":"failed","packagename":"","alertScore":0,"alertObject":{"k8sApiObjects":[{"apiVersion":"apps/v1","kind":"Deployment","metadata":{"annotations":{"deployment.kubernetes.io/revision":"3","litmuschaos.io/chaos":"true","meta.helm.sh/release-name":"arklb","meta.helm.sh/release-namespace":"ark-cnf"},"creationTimestamp":"2023-05-27T11:58:34Z","generation":8,"labels":{"app.kubernetes.io/instance":"arklb","app.kubernetes.io/managed-by":"Helm","app.kubernetes.io/name":"arklb","app.kubernetes.io/version":"v0.1.10","helm.sh/chart":"arklb-0.1.11"},"name":"arklb","namespace":"ark-cnf","resourceVersion":"2260893","uid":"cc4b4ff4-8e89-475f-beb8-0a715c1fcac1"}}]},"rulename":"ingress-and-egress-blocked"},{"alertMessage":"","failedPaths":null,"fixPaths":null,"ruleStatus":"failed","packagename":"","alertScore":0,"alertObject":{"k8sApiObjects":[{"apiVersion":"apps/v1","kind":"DaemonSet","metadata":{"annotations":{"components.gke.io/layer":"addon","deprecated.daemonset.template.generation":"3"},"creationTimestamp":"2023-05-25T09:54:08Z","generation":3,"labels":{"addonmanager.kubernetes.io/mode":"Reconcile"},"name":"collector","namespace":"gmp-system","resourceVersion":"1612265","uid":"c9eacc38-ca9b-4a5a-8bad-3e4d6d5372a2"}}]},"rulename":"ingress-and-egress-blocked"},{"alertMessage":"","failedPaths":null,"fixPaths":null,"ruleStatus":"failed","packagename":"","alertScore":0,"alertObject":{"k8sApiObjects":[{"apiVersion":"apps/v1","kind":"Deployment","metadata":{"annotations":{"components.gke.io/layer":"addon","deployment.kubernetes.io/revision":"3"},"creationTimestamp":"2023-05-25T09:54:08Z","generation":3,"labels":{"addonmanager.kubernetes.io/mode":"Reconcile"},"name":"rule-evaluator","namespace":"gmp-system","resourceVersion":"1607906","uid":"914f272c-aa43-451d-aed1-f0f1a67122f0"}}]},"rulename":"ingress-and-egress-blocked"},{"alertMessage":"","failedPaths":null,"fixPaths":null,"ruleStatus":"failed","packagename":"","alertScore":0,"alertObject":{"k8sApiObjects":[{"apiVersion":"apps/v1","kind":"StatefulSet","metadata":{"annotations":{"components.gke.io/layer":"addon"},"creationTimestamp":"2023-05-25T09:54:09Z","generation":2,"labels":{"addonmanager.kubernetes.io/mode":"Reconcile"},"name":"alertmanager","namespace":"gmp-system","resourceVersion":"1607794","uid":"e66b74b2-05fb-4f4c-a2f4-f9a234365c64"}}]},"rulename":"ingress-and-egress-blocked"},{"alertMessage":"","failedPaths":null,"fixPaths":null,"ruleStatus":"failed","packagename":"","alertScore":0,"alertObject":{"k8sApiObjects":[{"apiVersion":"apps/v1","kind":"Deployment","metadata":{"annotations":{"deployment.kubernetes.io/revision":"1"},"creationTimestamp":"2023-05-26T15:05:43Z","generation":1,"labels":{"k8s-app":"dashboard-metrics-scraper"},"name":"dashboard-metrics-scraper","namespace":"kubernetes-dashboard","resourceVersion":"2261246","uid":"63c8492b-c4e8-4b20-a6fb-6e45d5defe22"}}]},"rulename":"ingress-and-egress-blocked"},{"alertMessage":"","failedPaths":null,"fixPaths":null,"ruleStatus":"failed","packagename":"","alertScore":0,"alertObject":{"k8sApiObjects":[{"apiVersion":"apps/v1","kind":"Deployment","metadata":{"annotations":{"deployment.kubernetes.io/revision":"1"},"creationTimestamp":"2023-05-26T15:05:43Z","generation":1,"labels":{"k8s-app":"kubernetes-dashboard"},"name":"kubernetes-dashboard","namespace":"kubernetes-dashboard","resourceVersion":"1616115","uid":"f9cf23dc-f9bf-406f-9a85-913be6f490d2"}}]},"rulename":"ingress-and-egress-blocked"}],"listInputIDs":["apps/v1/gmp-system/Deployment/gmp-operator","apps/v1/ark-cnf/Deployment/arklb","apps/v1/gmp-system/DaemonSet/collector","apps/v1/gmp-system/Deployment/rule-evaluator","apps/v1/gmp-system/StatefulSet/alertmanager","apps/v1/kubernetes-dashboard/Deployment/dashboard-metrics-scraper","apps/v1/kubernetes-dashboard/Deployment/kubernetes-dashboard"],"totalResources":7,"failedResources":7,"warningResources":0}],"remediation":"Define a network policy that restricts ingress and egress connections.","description":"Disable Ingress and Egress traffic on all pods wherever possible. It is recommended to define restrictive network policy on all new PODs, and then enable sources/destinations that this POD must communicate with.","score":100,"baseScore":6,"totalResources":7,"failedResources":7,"warningResources":0},{"guid":"","id":"C-0066","controlID":"C-0066","name":"Secret/ETCD encryption enabled","ruleReports":[],"remediation":"Turn on the etcd encryption in your cluster, for more see the vendor documentation.","description":"All Kubernetes Secrets are stored primarily in etcd therefore it is important to encrypt it.","score":0,"baseScore":3,"totalResources":0,"failedResources":0,"warningResources":0},{"guid":"","id":"C-0038","controlID":"C-0038","name":"Host PID/IPC privileges","ruleReports":[{"name":"host-pid-ipc-privileges","remediation":"","ruleStatus":{"status":"success","message":""},"ruleResponses":null,"listInputIDs":["apps/v1/kubernetes-dashboard/Deployment/dashboard-metrics-scraper","apps/v1/kubernetes-dashboard/Deployment/kubernetes-dashboard","apps/v1/gmp-system/Deployment/rule-evaluator","apps/v1/gmp-system/Deployment/gmp-operator","apps/v1/gmp-system/StatefulSet/alertmanager","apps/v1/gmp-system/DaemonSet/collector","apps/v1/ark-cnf/Deployment/arklb"],"totalResources":7,"failedResources":0,"warningResources":0}],"remediation":"Remove hostPID and hostIPC from the yaml file(s) privileges unless they are absolutely necessary.","description":"Containers should be isolated from the host machine as much as possible. The hostPID and hostIPC fields in deployment yaml may allow cross-container influence and may expose the host itself to potentially malicious or destructive actions. This control identifies all PODs using hostPID or hostIPC privileges.","score":0,"baseScore":5,"totalResources":7,"failedResources":0,"warningResources":0},{"guid":"","id":"C-0017","controlID":"C-0017","name":"Immutable container filesystem","ruleReports":[{"name":"immutable-container-filesystem","remediation":"","ruleStatus":{"status":"success","message":""},"ruleResponses":[{"alertMessage":"","failedPaths":null,"fixPaths":[{"path":"spec.template.spec.containers[0].securityContext.readOnlyRootFilesystem","value":"true"},{"path":"spec.template.spec.containers[1].securityContext.readOnlyRootFilesystem","value":"true"}],"ruleStatus":"failed","packagename":"","alertScore":0,"alertObject":{"k8sApiObjects":[{"apiVersion":"apps/v1","kind":"StatefulSet","metadata":{"annotations":{"components.gke.io/layer":"addon"},"creationTimestamp":"2023-05-25T09:54:09Z","generation":2,"labels":{"addonmanager.kubernetes.io/mode":"Reconcile"},"name":"alertmanager","namespace":"gmp-system","resourceVersion":"1607794","uid":"e66b74b2-05fb-4f4c-a2f4-f9a234365c64"}}]},"rulename":"immutable-container-filesystem"},{"alertMessage":"","failedPaths":null,"fixPaths":[{"path":"spec.template.spec.containers[0].securityContext.readOnlyRootFilesystem","value":"true"},{"path":"spec.template.spec.containers[1].securityContext.readOnlyRootFilesystem","value":"true"}],"ruleStatus":"failed","packagename":"","alertScore":0,"alertObject":{"k8sApiObjects":[{"apiVersion":"apps/v1","kind":"DaemonSet","metadata":{"annotations":{"components.gke.io/layer":"addon","deprecated.daemonset.template.generation":"3"},"creationTimestamp":"2023-05-25T09:54:08Z","generation":3,"labels":{"addonmanager.kubernetes.io/mode":"Reconcile"},"name":"collector","namespace":"gmp-system","resourceVersion":"1612265","uid":"c9eacc38-ca9b-4a5a-8bad-3e4d6d5372a2"}}]},"rulename":"immutable-container-filesystem"},{"alertMessage":"","failedPaths":null,"fixPaths":[{"path":"spec.template.spec.containers[0].securityContext.readOnlyRootFilesystem","value":"true"}],"ruleStatus":"failed","packagename":"","alertScore":0,"alertObject":{"k8sApiObjects":[{"apiVersion":"apps/v1","kind":"Deployment","metadata":{"annotations":{"deployment.kubernetes.io/revision":"3","litmuschaos.io/chaos":"true","meta.helm.sh/release-name":"arklb","meta.helm.sh/release-namespace":"ark-cnf"},"creationTimestamp":"2023-05-27T11:58:34Z","generation":8,"labels":{"app.kubernetes.io/instance":"arklb","app.kubernetes.io/managed-by":"Helm","app.kubernetes.io/name":"arklb","app.kubernetes.io/version":"v0.1.10","helm.sh/chart":"arklb-0.1.11"},"name":"arklb","namespace":"ark-cnf","resourceVersion":"2260893","uid":"cc4b4ff4-8e89-475f-beb8-0a715c1fcac1"}}]},"rulename":"immutable-container-filesystem"},{"alertMessage":"","failedPaths":null,"fixPaths":[{"path":"spec.template.spec.containers[0].securityContext.readOnlyRootFilesystem","value":"true"},{"path":"spec.template.spec.containers[1].securityContext.readOnlyRootFilesystem","value":"true"}],"ruleStatus":"failed","packagename":"","alertScore":0,"alertObject":{"k8sApiObjects":[{"apiVersion":"apps/v1","kind":"Deployment","metadata":{"annotations":{"components.gke.io/layer":"addon","deployment.kubernetes.io/revision":"3"},"creationTimestamp":"2023-05-25T09:54:08Z","generation":3,"labels":{"addonmanager.kubernetes.io/mode":"Reconcile"},"name":"rule-evaluator","namespace":"gmp-system","resourceVersion":"1607906","uid":"914f272c-aa43-451d-aed1-f0f1a67122f0"}}]},"rulename":"immutable-container-filesystem"},{"alertMessage":"","failedPaths":null,"fixPaths":[{"path":"spec.template.spec.containers[0].securityContext.readOnlyRootFilesystem","value":"true"}],"ruleStatus":"failed","packagename":"","alertScore":0,"alertObject":{"k8sApiObjects":[{"apiVersion":"apps/v1","kind":"Deployment","metadata":{"annotations":{"components.gke.io/layer":"addon","deployment.kubernetes.io/revision":"3"},"creationTimestamp":"2023-05-25T09:54:04Z","generation":3,"labels":{"addonmanager.kubernetes.io/mode":"Reconcile","app":"managed-prometheus-operator","app.kubernetes.io/component":"operator","app.kubernetes.io/name":"gmp-operator","app.kubernetes.io/part-of":"gmp"},"name":"gmp-operator","namespace":"gmp-system","resourceVersion":"1607645","uid":"7aba6022-9924-4e8d-968d-e5b8cd22b059"}}]},"rulename":"immutable-container-filesystem"}],"listInputIDs":["apps/v1/gmp-system/StatefulSet/alertmanager","apps/v1/gmp-system/DaemonSet/collector","apps/v1/ark-cnf/Deployment/arklb","apps/v1/kubernetes-dashboard/Deployment/dashboard-metrics-scraper","apps/v1/kubernetes-dashboard/Deployment/kubernetes-dashboard","apps/v1/gmp-system/Deployment/rule-evaluator","apps/v1/gmp-system/Deployment/gmp-operator"],"totalResources":7,"failedResources":5,"warningResources":0}],"remediation":"Set the filesystem of the container to read-only when possible (POD securityContext, readOnlyRootFilesystem: true). If containers application needs to write into the filesystem, it is recommended to mount secondary filesystems for specific directories where application require write access.","description":"Mutable container filesystem can be abused to inject malicious code or data into containers. Use immutable (read-only) filesystem to limit potential attacks.","score":71.42857,"baseScore":3,"totalResources":7,"failedResources":5,"warningResources":0},{"guid":"","id":"C-0035","controlID":"C-0035","name":"Cluster-admin binding","ruleReports":[{"name":"rule-list-all-cluster-admins-v1","remediation":"","ruleStatus":{"status":"success","message":""},"ruleResponses":[{"alertMessage":"","failedPaths":["relatedObjects[1].rules[0].resources[0]","relatedObjects[1].rules[0].verbs[0]","relatedObjects[1].rules[0].apiGroups[0]","relatedObjects[0].subjects[0]","relatedObjects[0].roleRef.name"],"fixPaths":null,"ruleStatus":"excluded","packagename":"","alertScore":0,"alertObject":{"k8sApiObjects":[{"apiGroup":"rbac.authorization.k8s.io","kind":"User","name":"system:storageversionmigrator","relatedObjects":[{"apiVersion":"rbac.authorization.k8s.io/v1","kind":"ClusterRoleBinding","metadata":{"annotations":{"components.gke.io/component-name":"storageversionmigrator-rbac","components.gke.io/component-version":"0.0.4"},"creationTimestamp":"2023-05-24T16:40:47Z","labels":{"addonmanager.kubernetes.io/mode":"Reconcile"},"name":"storage-version-migration-migrator-v2","resourceVersion":"795","uid":"6f37ffca-40fd-4246-b8ed-e42291f2968e"},"roleRef":{"apiGroup":"rbac.authorization.k8s.io","kind":"ClusterRole","name":"cluster-admin"},"subjects":[{"apiGroup":"rbac.authorization.k8s.io","kind":"User","name":"system:storageversionmigrator"}]},{"apiVersion":"rbac.authorization.k8s.io/v1","kind":"ClusterRole","metadata":{"annotations":{"rbac.authorization.kubernetes.io/autoupdate":"true"},"creationTimestamp":"2023-05-24T16:39:18Z","labels":{"kubernetes.io/bootstrapping":"rbac-defaults"},"name":"cluster-admin","resourceVersion":"54","uid":"4e29ea6f-cb33-42c3-9c14-15cb6817d8e3"},"rules":[{"apiGroups":["*"],"resources":["*"],"verbs":["*"]},{"nonResourceURLs":["*"],"verbs":["*"]}]}]}]},"rulename":"rule-list-all-cluster-admins-v1","exception":{"guid":"","name":"exclude-system-users-and-groups-13","attributes":{"systemException":true},"policyType":"postureExceptionPolicy","creationTime":"","actions":["alertOnly"],"resources":[{"designatorType":"Attributes","attributes":{"kind":"User","name":"system:storageversionmigrator"}}],"posturePolicies":[{"frameworkName":""}]}},{"alertMessage":"","failedPaths":["relatedObjects[1].rules[0].resources[0]","relatedObjects[1].rules[0].verbs[0]","relatedObjects[1].rules[0].apiGroups[0]","relatedObjects[0].subjects[0]","relatedObjects[0].roleRef.name"],"fixPaths":null,"ruleStatus":"excluded","packagename":"","alertScore":0,"alertObject":{"k8sApiObjects":[{"apiGroup":"rbac.authorization.k8s.io","kind":"Group","name":"system:masters","relatedObjects":[{"apiVersion":"rbac.authorization.k8s.io/v1","kind":"ClusterRoleBinding","metadata":{"annotations":{"rbac.authorization.kubernetes.io/autoupdate":"true"},"creationTimestamp":"2023-05-24T16:39:21Z","labels":{"kubernetes.io/bootstrapping":"rbac-defaults"},"name":"cluster-admin","resourceVersion":"133","uid":"6ee37239-391e-4662-a96f-8e1b22849358"},"roleRef":{"apiGroup":"rbac.authorization.k8s.io","kind":"ClusterRole","name":"cluster-admin"},"subjects":[{"apiGroup":"rbac.authorization.k8s.io","kind":"Group","name":"system:masters"}]},{"apiVersion":"rbac.authorization.k8s.io/v1","kind":"ClusterRole","metadata":{"annotations":{"rbac.authorization.kubernetes.io/autoupdate":"true"},"creationTimestamp":"2023-05-24T16:39:18Z","labels":{"kubernetes.io/bootstrapping":"rbac-defaults"},"name":"cluster-admin","resourceVersion":"54","uid":"4e29ea6f-cb33-42c3-9c14-15cb6817d8e3"},"rules":[{"apiGroups":["*"],"resources":["*"],"verbs":["*"]},{"nonResourceURLs":["*"],"verbs":["*"]}]}]}]},"rulename":"rule-list-all-cluster-admins-v1","exception":{"guid":"","name":"exclude-system-users-and-groups-3","attributes":{"systemException":true},"policyType":"postureExceptionPolicy","creationTime":"","actions":["alertOnly"],"resources":[{"designatorType":"Attributes","attributes":{"apiVersion":"rbac.authorization.k8s.io","kind":"Group","name":"system:masters"}}],"posturePolicies":[{"frameworkName":""}]}}],"listInputIDs":["/kube-system/ServiceAccount/pod-garbage-collector/rbac.authorization.k8s.io/v1//ClusterRole/system:controller:pod-garbage-collector/rbac.authorization.k8s.io/v1//ClusterRoleBinding/system:controller:pod-garbage-collector","rbac.authorization.k8s.io//User/system:kube-scheduler/rbac.authorization.k8s.io/v1//ClusterRole/system:kube-scheduler/rbac.authorization.k8s.io/v1//ClusterRoleBinding/system:kube-scheduler","rbac.authorization.k8s.io//User/kubelet/rbac.authorization.k8s.io/v1//ClusterRole/system:node-bootstrapper/rbac.authorization.k8s.io/v1//ClusterRoleBinding/kubelet-bootstrap","rbac.authorization.k8s.io//Group/system:unauthenticated/rbac.authorization.k8s.io/v1//ClusterRole/system:public-info-viewer/rbac.authorization.k8s.io/v1//ClusterRoleBinding/system:public-info-viewer","/kube-system/ServiceAccount/ephemeral-volume-controller/rbac.authorization.k8s.io/v1//ClusterRole/system:controller:ephemeral-volume-controller/rbac.authorization.k8s.io/v1//ClusterRoleBinding/system:controller:ephemeral-volume-controller","/kubernetes-dashboard/ServiceAccount/kubernetes-dashboard/rbac.authorization.k8s.io/v1//ClusterRole/kubernetes-dashboard/rbac.authorization.k8s.io/v1//ClusterRoleBinding/kubernetes-dashboard","/kube-system/ServiceAccount/pv-protection-controller/rbac.authorization.k8s.io/v1//ClusterRole/system:controller:pv-protection-controller/rbac.authorization.k8s.io/v1//ClusterRoleBinding/system:controller:pv-protection-controller","/kube-system/ServiceAccount/service-account-controller/rbac.authorization.k8s.io/v1//ClusterRole/system:controller:service-account-controller/rbac.authorization.k8s.io/v1//ClusterRoleBinding/system:controller:service-account-controller","rbac.authorization.k8s.io//User/system:pdcsi-controller/rbac.authorization.k8s.io/v1//ClusterRole/pdcsi-attacher-role/rbac.authorization.k8s.io/v1//ClusterRoleBinding/pdcsi-controller-attacher-binding","rbac.authorization.k8s.io/kube-system/User/system:vpa-recommender/rbac.authorization.k8s.io/v1//ClusterRole/external-metrics-reader/rbac.authorization.k8s.io/v1//ClusterRoleBinding/uas-hpa-external-metrics-reader","/kube-system/ServiceAccount/endpointslice-controller/rbac.authorization.k8s.io/v1//ClusterRole/system:controller:endpointslice-controller/rbac.authorization.k8s.io/v1//ClusterRoleBinding/system:controller:endpointslice-controller","/kube-system/ServiceAccount/service-controller/rbac.authorization.k8s.io/v1//ClusterRole/system:controller:service-controller/rbac.authorization.k8s.io/v1//ClusterRoleBinding/system:controller:service-controller","/kube-system/ServiceAccount/generic-garbage-collector/rbac.authorization.k8s.io/v1//ClusterRole/system:controller:generic-garbage-collector/rbac.authorization.k8s.io/v1//ClusterRoleBinding/system:controller:generic-garbage-collector","rbac.authorization.k8s.io//User/system:storageversionmigrator/rbac.authorization.k8s.io/v1//ClusterRole/storage-version-migration-crd-creator/rbac.authorization.k8s.io/v1//ClusterRoleBinding/storage-version-migration-crd-creator","/kube-system/ServiceAccount/persistent-volume-binder/rbac.authorization.k8s.io/v1//ClusterRole/system:controller:persistent-volume-binder/rbac.authorization.k8s.io/v1//ClusterRoleBinding/system:controller:persistent-volume-binder","rbac.authorization.k8s.io//Group/system:nodes/rbac.authorization.k8s.io/v1//ClusterRole/gce:beta:kubelet-certificate-rotation/rbac.authorization.k8s.io/v1//ClusterRoleBinding/gce:beta:kubelet-certificate-rotation","rbac.authorization.k8s.io//Group/system:monitoring/rbac.authorization.k8s.io/v1//ClusterRole/system:monitoring/rbac.authorization.k8s.io/v1//ClusterRoleBinding/system:monitoring","/kube-system/ServiceAccount/kube-dns-autoscaler/rbac.authorization.k8s.io/v1//ClusterRole/system:kube-dns-autoscaler/rbac.authorization.k8s.io/v1//ClusterRoleBinding/system:kube-dns-autoscaler","/kube-system/ServiceAccount/konnectivity-agent-cpha/rbac.authorization.k8s.io/v1//ClusterRole/konnectivity-agent-cpha/rbac.authorization.k8s.io/v1//ClusterRoleBinding/konnectivity-agent-cpha","rbac.authorization.k8s.io//User/system:snapshot-controller/rbac.authorization.k8s.io/v1//ClusterRole/snapshot-controller-runner/rbac.authorization.k8s.io/v1//ClusterRoleBinding/snapshot-controller-role","/kube-system/ServiceAccount/expand-controller/rbac.authorization.k8s.io/v1//ClusterRole/system:controller:expand-controller/rbac.authorization.k8s.io/v1//ClusterRoleBinding/system:controller:expand-controller","rbac.authorization.k8s.io/kube-system/User/system:vpa-recommender/rbac.authorization.k8s.io/v1//ClusterRole/system:gke-hpa-service-reader/rbac.authorization.k8s.io/v1//ClusterRoleBinding/system:gke-hpa-service-reader","rbac.authorization.k8s.io//User/kubelet/rbac.authorization.k8s.io/v1//ClusterRole/system:node-problem-detector/rbac.authorization.k8s.io/v1//ClusterRoleBinding/kubelet-user-npd-binding","rbac.authorization.k8s.io/kube-system/User/system:cluster-autoscaler/rbac.authorization.k8s.io/v1//ClusterRole/ca-cr-actor/rbac.authorization.k8s.io/v1//ClusterRoleBinding/ca-cr","rbac.authorization.k8s.io//User/system:gke-common-webhooks/rbac.authorization.k8s.io/v1//ClusterRole/system:gke-common-webhooks/rbac.authorization.k8s.io/v1//ClusterRoleBinding/system:gke-common-webhooks","/kube-system/ServiceAccount/disruption-controller/rbac.authorization.k8s.io/v1//ClusterRole/system:controller:disruption-controller/rbac.authorization.k8s.io/v1//ClusterRoleBinding/system:controller:disruption-controller","/kube-system/ServiceAccount/attachdetach-controller/rbac.authorization.k8s.io/v1//ClusterRole/system:controller:attachdetach-controller/rbac.authorization.k8s.io/v1//ClusterRoleBinding/system:controller:attachdetach-controller","/gmp-system/ServiceAccount/operator/rbac.authorization.k8s.io/v1/gmp-public/Role/operator/rbac.authorization.k8s.io/v1/gmp-system/RoleBinding/operator","/gmp-system/ServiceAccount/operator/rbac.authorization.k8s.io/v1/gmp-public/Role/operator/rbac.authorization.k8s.io/v1/gmp-public/RoleBinding/operator","rbac.authorization.k8s.io//User/system:storageversionmigrator/rbac.authorization.k8s.io/v1//ClusterRole/storage-version-migration-initializer/rbac.authorization.k8s.io/v1//ClusterRoleBinding/storage-version-migration-initializer","/kube-system/ServiceAccount/daemon-set-controller/rbac.authorization.k8s.io/v1//ClusterRole/system:controller:daemon-set-controller/rbac.authorization.k8s.io/v1//ClusterRoleBinding/system:controller:daemon-set-controller","rbac.authorization.k8s.io/kube-system/User/system:vpa-recommender/rbac.authorization.k8s.io/v1//ClusterRole/system:gke-uas-metrics-reader/rbac.authorization.k8s.io/v1//ClusterRoleBinding/system:gke-uas-metrics-reader","rbac.authorization.k8s.io/kube-system/User/system:vpa-recommender/rbac.authorization.k8s.io/v1//ClusterRole/system:gke-hpa-actor/rbac.authorization.k8s.io/v1//ClusterRoleBinding/system:gke-hpa-actor","/kube-system/ServiceAccount/kube-dns/rbac.authorization.k8s.io/v1//ClusterRole/system:kube-dns/rbac.authorization.k8s.io/v1//ClusterRoleBinding/system:kube-dns","rbac.authorization.k8s.io//User/system:storageversionmigrator/rbac.authorization.k8s.io/v1//ClusterRole/cluster-admin/rbac.authorization.k8s.io/v1//ClusterRoleBinding/storage-version-migration-migrator-v2","rbac.authorization.k8s.io//User/system:cloud-controller-manager/rbac.authorization.k8s.io/v1//ClusterRole/system:cloud-controller-manager/rbac.authorization.k8s.io/v1//ClusterRoleBinding/system:cloud-controller-manager","/kube-system/ServiceAccount/ttl-after-finished-controller/rbac.authorization.k8s.io/v1//ClusterRole/system:controller:ttl-after-finished-controller/rbac.authorization.k8s.io/v1//ClusterRoleBinding/system:controller:ttl-after-finished-controller","rbac.authorization.k8s.io//User/system:master-prom-to-sd-monitor/rbac.authorization.k8s.io/v1//ClusterRole/system:master-monitoring-role/rbac.authorization.k8s.io/v1//ClusterRoleBinding/master-monitoring-role-binding","rbac.authorization.k8s.io//Group/system:authenticated/rbac.authorization.k8s.io/v1//ClusterRole/system:basic-user/rbac.authorization.k8s.io/v1//ClusterRoleBinding/system:basic-user","rbac.authorization.k8s.io//User/system:resource-tracker/rbac.authorization.k8s.io/v1//ClusterRole/system:resource-tracker/rbac.authorization.k8s.io/v1//ClusterRoleBinding/system:resource-tracker","rbac.authorization.k8s.io//User/kubelet/rbac.authorization.k8s.io/v1//ClusterRole/gce:beta:kubelet-certificate-bootstrap/rbac.authorization.k8s.io/v1//ClusterRoleBinding/gce:beta:kubelet-certificate-bootstrap","/kube-system/ServiceAccount/endpoint-controller/rbac.authorization.k8s.io/v1//ClusterRole/system:controller:endpoint-controller/rbac.authorization.k8s.io/v1//ClusterRoleBinding/system:controller:endpoint-controller","/kube-system/ServiceAccount/certificate-controller/rbac.authorization.k8s.io/v1//ClusterRole/system:controller:certificate-controller/rbac.authorization.k8s.io/v1//ClusterRoleBinding/system:controller:certificate-controller","/kubernetes-dashboard/ServiceAccount/kubernetes-dashboard/rbac.authorization.k8s.io/v1/kubernetes-dashboard/Role/kubernetes-dashboard/rbac.authorization.k8s.io/v1/kubernetes-dashboard/RoleBinding/kubernetes-dashboard","/kube-system/ServiceAccount/ttl-controller/rbac.authorization.k8s.io/v1//ClusterRole/system:controller:ttl-controller/rbac.authorization.k8s.io/v1//ClusterRoleBinding/system:controller:ttl-controller","rbac.authorization.k8s.io//User/system:pdcsi-controller/rbac.authorization.k8s.io/v1//ClusterRole/pdcsi-snapshotter-role/rbac.authorization.k8s.io/v1//ClusterRoleBinding/pdcsi-snapshotter-binding","rbac.authorization.k8s.io//Group/system:authenticated/rbac.authorization.k8s.io/v1//ClusterRole/system:discovery/rbac.authorization.k8s.io/v1//ClusterRoleBinding/system:discovery","rbac.authorization.k8s.io//Group/system:masters/rbac.authorization.k8s.io/v1//ClusterRole/cluster-admin/rbac.authorization.k8s.io/v1//ClusterRoleBinding/cluster-admin","/kube-system/ServiceAccount/clusterrole-aggregation-controller/rbac.authorization.k8s.io/v1//ClusterRole/system:controller:clusterrole-aggregation-controller/rbac.authorization.k8s.io/v1//ClusterRoleBinding/system:controller:clusterrole-aggregation-controller","rbac.authorization.k8s.io//User/cluster-autoscaler/rbac.authorization.k8s.io/v1//ClusterRole/read-updateinfo/rbac.authorization.k8s.io/v1//ClusterRoleBinding/cluster-autoscaler-updateinfo","rbac.authorization.k8s.io//User/system:l7-lb-controller/rbac.authorization.k8s.io/v1//ClusterRole/system:glbc-status/rbac.authorization.k8s.io/v1//ClusterRoleBinding/system:glbc-status","rbac.authorization.k8s.io//User/system:gcp-controller-manager/rbac.authorization.k8s.io/v1//ClusterRole/system:gcp-controller-manager/rbac.authorization.k8s.io/v1//ClusterRoleBinding/system:gcp-controller-manager","rbac.authorization.k8s.io//User/system:gke-master-resourcequota/rbac.authorization.k8s.io/v1//ClusterRole/system:gke-master-resourcequota/rbac.authorization.k8s.io/v1//ClusterRoleBinding/system:gke-master-resourcequota","/kube-system/ServiceAccount/gke-metrics-agent/rbac.authorization.k8s.io/v1//ClusterRole/gke-metrics-agent/rbac.authorization.k8s.io/v1//ClusterRoleBinding/gke-metrics-agent","/kube-system/ServiceAccount/cloud-provider/rbac.authorization.k8s.io/v1//ClusterRole/gce:cloud-provider/rbac.authorization.k8s.io/v1//ClusterRoleBinding/gce:cloud-provider","rbac.authorization.k8s.io//User/system:kubestore-collector/rbac.authorization.k8s.io/v1//ClusterRole/system:kubestore-collector/rbac.authorization.k8s.io/v1//ClusterRoleBinding/system:kubestore-collector","rbac.authorization.k8s.io//User/system:kube-scheduler/rbac.authorization.k8s.io/v1//ClusterRole/system:volume-scheduler/rbac.authorization.k8s.io/v1//ClusterRoleBinding/system:volume-scheduler","/gmp-system/ServiceAccount/operator/rbac.authorization.k8s.io/v1/gmp-system/Role/operator/rbac.authorization.k8s.io/v1/gmp-system/RoleBinding/operator","/kube-system/ServiceAccount/replicaset-controller/rbac.authorization.k8s.io/v1//ClusterRole/system:controller:replicaset-controller/rbac.authorization.k8s.io/v1//ClusterRoleBinding/system:controller:replicaset-controller","/gmp-system/ServiceAccount/collector/rbac.authorization.k8s.io/v1//ClusterRole/gmp-system:collector/rbac.authorization.k8s.io/v1//ClusterRoleBinding/gmp-system:collector","rbac.authorization.k8s.io//User/system:kube-controller-manager/rbac.authorization.k8s.io/v1//ClusterRole/system:kube-controller-manager/rbac.authorization.k8s.io/v1//ClusterRoleBinding/system:kube-controller-manager","/litmus/ServiceAccount/litmus/rbac.authorization.k8s.io/v1//ClusterRole/litmus/rbac.authorization.k8s.io/v1//ClusterRoleBinding/litmus","/ark-cnf/ServiceAccount/node-drain-sa/rbac.authorization.k8s.io/v1//ClusterRole/node-drain-sa/rbac.authorization.k8s.io/v1//ClusterRoleBinding/node-drain-sa","/kube-system/ServiceAccount/event-exporter-sa/rbac.authorization.k8s.io/v1//ClusterRole/view/rbac.authorization.k8s.io/v1//ClusterRoleBinding/event-exporter-rb","rbac.authorization.k8s.io//User/system:pdcsi-controller/rbac.authorization.k8s.io/v1//ClusterRole/pdcsi-provisioner-role/rbac.authorization.k8s.io/v1//ClusterRoleBinding/pdcsi-controller-provisioner-binding","rbac.authorization.k8s.io/kube-system/User/system:vpa-recommender/rbac.authorization.k8s.io/v1//ClusterRole/system:gke-uas-collection-reader/rbac.authorization.k8s.io/v1//ClusterRoleBinding/system:gke-uas-collection-reader","/gmp-system/ServiceAccount/operator/rbac.authorization.k8s.io/v1//ClusterRole/gmp-system:operator/rbac.authorization.k8s.io/v1//ClusterRoleBinding/gmp-system:operator","rbac.authorization.k8s.io//User/system:managed-certificate-controller/rbac.authorization.k8s.io/v1//ClusterRole/system:managed-certificate-controller/rbac.authorization.k8s.io/v1//ClusterRoleBinding/system:managed-certificate-controller","rbac.authorization.k8s.io//User/system:pdcsi-controller/rbac.authorization.k8s.io/v1//ClusterRole/pdcsi-resizer-role/rbac.authorization.k8s.io/v1//ClusterRoleBinding/pdcsi-controller-resizer-binding","rbac.authorization.k8s.io//User/system:storageversionmigrator/rbac.authorization.k8s.io/v1//ClusterRole/storage-version-migration-trigger/rbac.authorization.k8s.io/v1//ClusterRoleBinding/storage-version-migration-trigger","rbac.authorization.k8s.io//User/kubelet-bootstrap/rbac.authorization.k8s.io/v1//ClusterRole/system:node-bootstrapper/rbac.authorization.k8s.io/v1//ClusterRoleBinding/kubelet-bootstrap-node-bootstrapper","rbac.authorization.k8s.io//User/system:clustermetrics/rbac.authorization.k8s.io/v1//ClusterRole/system:clustermetrics/rbac.authorization.k8s.io/v1//ClusterRoleBinding/system:clustermetrics","/kube-system/ServiceAccount/pvc-protection-controller/rbac.authorization.k8s.io/v1//ClusterRole/system:controller:pvc-protection-controller/rbac.authorization.k8s.io/v1//ClusterRoleBinding/system:controller:pvc-protection-controller","rbac.authorization.k8s.io/kube-system/User/system:vpa-recommender/rbac.authorization.k8s.io/v1//ClusterRole/system:controller:horizontal-pod-autoscaler/rbac.authorization.k8s.io/v1//ClusterRoleBinding/system:gke-uas-hpa-controller","rbac.authorization.k8s.io/kube-system/User/system:cluster-autoscaler/rbac.authorization.k8s.io/v1//ClusterRole/cluster-autoscaler/rbac.authorization.k8s.io/v1//ClusterRoleBinding/cluster-autoscaler","/gmp-system/ServiceAccount/operator/rbac.authorization.k8s.io/v1/gmp-public/RoleBinding/operator/rbac.authorization.k8s.io/v1/gmp-system/Role/operator","/kube-system/ServiceAccount/cronjob-controller/rbac.authorization.k8s.io/v1//ClusterRole/system:controller:cronjob-controller/rbac.authorization.k8s.io/v1//ClusterRoleBinding/system:controller:cronjob-controller","/kube-system/ServiceAccount/metrics-server/rbac.authorization.k8s.io/v1//ClusterRole/system:auth-delegator/rbac.authorization.k8s.io/v1//ClusterRoleBinding/metrics-server:system:auth-delegator","rbac.authorization.k8s.io//User/kubelet-bootstrap/rbac.authorization.k8s.io/v1//ClusterRole/gce:beta:kubelet-certificate-bootstrap/rbac.authorization.k8s.io/v1//ClusterRoleBinding/kubelet-bootstrap-certificate-bootstrap","/kube-system/ServiceAccount/root-ca-cert-publisher/rbac.authorization.k8s.io/v1//ClusterRole/system:controller:root-ca-cert-publisher/rbac.authorization.k8s.io/v1//ClusterRoleBinding/system:controller:root-ca-cert-publisher","/kube-system/ServiceAccount/node-controller/rbac.authorization.k8s.io/v1//ClusterRole/system:controller:node-controller/rbac.authorization.k8s.io/v1//ClusterRoleBinding/system:controller:node-controller","rbac.authorization.k8s.io//Group/system:authenticated/rbac.authorization.k8s.io/v1//ClusterRole/system:public-info-viewer/rbac.authorization.k8s.io/v1//ClusterRoleBinding/system:public-info-viewer","/kube-system/ServiceAccount/job-controller/rbac.authorization.k8s.io/v1//ClusterRole/system:controller:job-controller/rbac.authorization.k8s.io/v1//ClusterRoleBinding/system:controller:job-controller","/kube-system/ServiceAccount/statefulset-controller/rbac.authorization.k8s.io/v1//ClusterRole/system:controller:statefulset-controller/rbac.authorization.k8s.io/v1//ClusterRoleBinding/system:controller:statefulset-controller","rbac.authorization.k8s.io/kube-system/User/system:vpa-recommender/rbac.authorization.k8s.io/v1//ClusterRole/system:gke-controller/rbac.authorization.k8s.io/v1//ClusterRoleBinding/system:gke-controller","/cnf-testsuite/ServiceAccount/falco/rbac.authorization.k8s.io/v1//ClusterRole/falco/rbac.authorization.k8s.io/v1//ClusterRoleBinding/falco","rbac.authorization.k8s.io//User/system:controller:glbc/rbac.authorization.k8s.io/v1//ClusterRole/system:glbc-status/rbac.authorization.k8s.io/v1//ClusterRoleBinding/system:glbc-status","rbac.authorization.k8s.io//User/system:konnectivity-server/rbac.authorization.k8s.io/v1//ClusterRole/system:auth-delegator/rbac.authorization.k8s.io/v1//ClusterRoleBinding/system:konnectivity-server","/kube-system/ServiceAccount/replication-controller/rbac.authorization.k8s.io/v1//ClusterRole/system:controller:replication-controller/rbac.authorization.k8s.io/v1//ClusterRoleBinding/system:controller:replication-controller","/kube-system/ServiceAccount/horizontal-pod-autoscaler/rbac.authorization.k8s.io/v1//ClusterRole/system:controller:horizontal-pod-autoscaler/rbac.authorization.k8s.io/v1//ClusterRoleBinding/system:controller:horizontal-pod-autoscaler","/kube-system/ServiceAccount/endpointslicemirroring-controller/rbac.authorization.k8s.io/v1//ClusterRole/system:controller:endpointslicemirroring-controller/rbac.authorization.k8s.io/v1//ClusterRoleBinding/system:controller:endpointslicemirroring-controller","rbac.authorization.k8s.io//Group/system:serviceaccounts/rbac.authorization.k8s.io/v1//ClusterRole/system:service-account-issuer-discovery/rbac.authorization.k8s.io/v1//ClusterRoleBinding/system:service-account-issuer-discovery","/kube-system/ServiceAccount/route-controller/rbac.authorization.k8s.io/v1//ClusterRole/system:controller:route-controller/rbac.authorization.k8s.io/v1//ClusterRoleBinding/system:controller:route-controller","/kube-system/ServiceAccount/metrics-server/rbac.authorization.k8s.io/v1//ClusterRole/system:metrics-server/rbac.authorization.k8s.io/v1//ClusterRoleBinding/system:metrics-server","rbac.authorization.k8s.io//User/system:node-problem-detector/rbac.authorization.k8s.io/v1//ClusterRole/system:node-problem-detector/rbac.authorization.k8s.io/v1//ClusterRoleBinding/npd-binding","/kube-system/ServiceAccount/resourcequota-controller/rbac.authorization.k8s.io/v1//ClusterRole/system:controller:resourcequota-controller/rbac.authorization.k8s.io/v1//ClusterRoleBinding/system:controller:resourcequota-controller","rbac.authorization.k8s.io//User/system:kube-proxy/rbac.authorization.k8s.io/v1//ClusterRole/system:node-proxier/rbac.authorization.k8s.io/v1//ClusterRoleBinding/system:node-proxier","/kube-system/ServiceAccount/kube-proxy/rbac.authorization.k8s.io/v1//ClusterRole/system:node-proxier/rbac.authorization.k8s.io/v1//ClusterRoleBinding/system:kube-proxy","/kube-system/ServiceAccount/deployment-controller/rbac.authorization.k8s.io/v1//ClusterRole/system:controller:deployment-controller/rbac.authorization.k8s.io/v1//ClusterRoleBinding/system:controller:deployment-controller","/kube-system/ServiceAccount/namespace-controller/rbac.authorization.k8s.io/v1//ClusterRole/system:controller:namespace-controller/rbac.authorization.k8s.io/v1//ClusterRoleBinding/system:controller:namespace-controller","rbac.authorization.k8s.io//User/system:slo-monitor/rbac.authorization.k8s.io/v1//ClusterRole/system:slo-monitor/rbac.authorization.k8s.io/v1//ClusterRoleBinding/system:slo-monitor","rbac.authorization.k8s.io//User/kube-apiserver/rbac.authorization.k8s.io/v1//ClusterRole/kubelet-api-admin/rbac.authorization.k8s.io/v1//ClusterRoleBinding/kube-apiserver-kubelet-api-admin"],"totalResources":102,"failedResources":0,"warningResources":2}],"remediation":"You should apply least privilege principle. Make sure cluster admin permissions are granted only when it is absolutely necessary. Don't use subjects with such high permissions for daily operations.","description":"Attackers who have cluster admin permissions (can perform any action on any resource), can take advantage of their privileges for malicious activities. This control determines which subjects have cluster admin permissions.","score":0,"baseScore":8,"totalResources":102,"failedResources":0,"warningResources":2},{"guid":"","id":"C-0002","controlID":"C-0002","name":"Exec into container","ruleReports":[{"name":"exec-into-container-v1","remediation":"","ruleStatus":{"status":"success","message":""},"ruleResponses":[{"alertMessage":"","failedPaths":["relatedObjects[1].rules[0].resources[0]","relatedObjects[1].rules[0].verbs[0]","relatedObjects[1].rules[0].apiGroups[0]","relatedObjects[0].subjects[0]","relatedObjects[0].roleRef.name"],"fixPaths":null,"ruleStatus":"excluded","packagename":"","alertScore":0,"alertObject":{"k8sApiObjects":[{"apiGroup":"rbac.authorization.k8s.io","kind":"User","name":"system:storageversionmigrator","relatedObjects":[{"apiVersion":"rbac.authorization.k8s.io/v1","kind":"ClusterRoleBinding","metadata":{"annotations":{"components.gke.io/component-name":"storageversionmigrator-rbac","components.gke.io/component-version":"0.0.4"},"creationTimestamp":"2023-05-24T16:40:47Z","labels":{"addonmanager.kubernetes.io/mode":"Reconcile"},"name":"storage-version-migration-migrator-v2","resourceVersion":"795","uid":"6f37ffca-40fd-4246-b8ed-e42291f2968e"},"roleRef":{"apiGroup":"rbac.authorization.k8s.io","kind":"ClusterRole","name":"cluster-admin"},"subjects":[{"apiGroup":"rbac.authorization.k8s.io","kind":"User","name":"system:storageversionmigrator"}]},{"apiVersion":"rbac.authorization.k8s.io/v1","kind":"ClusterRole","metadata":{"annotations":{"rbac.authorization.kubernetes.io/autoupdate":"true"},"creationTimestamp":"2023-05-24T16:39:18Z","labels":{"kubernetes.io/bootstrapping":"rbac-defaults"},"name":"cluster-admin","resourceVersion":"54","uid":"4e29ea6f-cb33-42c3-9c14-15cb6817d8e3"},"rules":[{"apiGroups":["*"],"resources":["*"],"verbs":["*"]},{"nonResourceURLs":["*"],"verbs":["*"]}]}]}]},"rulename":"exec-into-container-v1","exception":{"guid":"","name":"exclude-system-users-and-groups-13","attributes":{"systemException":true},"policyType":"postureExceptionPolicy","creationTime":"","actions":["alertOnly"],"resources":[{"designatorType":"Attributes","attributes":{"kind":"User","name":"system:storageversionmigrator"}}],"posturePolicies":[{"frameworkName":""}]}},{"alertMessage":"","failedPaths":["relatedObjects[1].rules[0].resources[0]","relatedObjects[1].rules[0].verbs[0]","relatedObjects[1].rules[0].apiGroups[0]","relatedObjects[0].subjects[0]","relatedObjects[0].roleRef.name"],"fixPaths":null,"ruleStatus":"excluded","packagename":"","alertScore":0,"alertObject":{"k8sApiObjects":[{"apiGroup":"rbac.authorization.k8s.io","kind":"Group","name":"system:masters","relatedObjects":[{"apiVersion":"rbac.authorization.k8s.io/v1","kind":"ClusterRoleBinding","metadata":{"annotations":{"rbac.authorization.kubernetes.io/autoupdate":"true"},"creationTimestamp":"2023-05-24T16:39:21Z","labels":{"kubernetes.io/bootstrapping":"rbac-defaults"},"name":"cluster-admin","resourceVersion":"133","uid":"6ee37239-391e-4662-a96f-8e1b22849358"},"roleRef":{"apiGroup":"rbac.authorization.k8s.io","kind":"ClusterRole","name":"cluster-admin"},"subjects":[{"apiGroup":"rbac.authorization.k8s.io","kind":"Group","name":"system:masters"}]},{"apiVersion":"rbac.authorization.k8s.io/v1","kind":"ClusterRole","metadata":{"annotations":{"rbac.authorization.kubernetes.io/autoupdate":"true"},"creationTimestamp":"2023-05-24T16:39:18Z","labels":{"kubernetes.io/bootstrapping":"rbac-defaults"},"name":"cluster-admin","resourceVersion":"54","uid":"4e29ea6f-cb33-42c3-9c14-15cb6817d8e3"},"rules":[{"apiGroups":["*"],"resources":["*"],"verbs":["*"]},{"nonResourceURLs":["*"],"verbs":["*"]}]}]}]},"rulename":"exec-into-container-v1","exception":{"guid":"","name":"exclude-system-users-and-groups-3","attributes":{"systemException":true},"policyType":"postureExceptionPolicy","creationTime":"","actions":["alertOnly"],"resources":[{"designatorType":"Attributes","attributes":{"apiVersion":"rbac.authorization.k8s.io","kind":"Group","name":"system:masters"}}],"posturePolicies":[{"frameworkName":""}]}},{"alertMessage":"","failedPaths":["relatedObjects[1].rules[4].resources[0]","relatedObjects[1].rules[4].verbs[2]","relatedObjects[1].rules[4].apiGroups[0]","relatedObjects[0].subjects[0]","relatedObjects[0].roleRef.name"],"fixPaths":null,"ruleStatus":"failed","packagename":"","alertScore":0,"alertObject":{"k8sApiObjects":[{"kind":"ServiceAccount","name":"node-drain-sa","namespace":"ark-cnf","relatedObjects":[{"apiVersion":"rbac.authorization.k8s.io/v1","kind":"ClusterRoleBinding","metadata":{"annotations":{},"creationTimestamp":"2023-05-24T17:00:48Z","labels":{"app.kubernetes.io/part-of":"litmus","name":"node-drain-sa"},"name":"node-drain-sa","resourceVersion":"12206","uid":"e8ccc9cc-1c4d-4091-bd31-08d173457f82"},"roleRef":{"apiGroup":"rbac.authorization.k8s.io","kind":"ClusterRole","name":"node-drain-sa"},"subjects":[{"kind":"ServiceAccount","name":"node-drain-sa","namespace":"ark-cnf"}]},{"apiVersion":"rbac.authorization.k8s.io/v1","kind":"ClusterRole","metadata":{"annotations":{},"creationTimestamp":"2023-05-24T17:00:47Z","labels":{"app.kubernetes.io/part-of":"litmus","name":"node-drain-sa"},"name":"node-drain-sa","resourceVersion":"12201","uid":"301e2ea4-d9dd-4b7a-a6ea-b7ad8e274aab"},"rules":[{"apiGroups":[""],"resources":["pods"],"verbs":["create","delete","get","list","patch","update","deletecollection"]},{"apiGroups":[""],"resources":["events"],"verbs":["create","get","list","patch","update"]},{"apiGroups":[""],"resources":["configmaps"],"verbs":["get","list"]},{"apiGroups":[""],"resources":["pods/log"],"verbs":["get","list","watch"]},{"apiGroups":[""],"resources":["pods/exec","pods/eviction"],"verbs":["get","list","create"]},{"apiGroups":["apps"],"resources":["daemonsets"],"verbs":["list","get","delete"]},{"apiGroups":["batch"],"resources":["jobs"],"verbs":["create","list","get","delete","deletecollection"]},{"apiGroups":["litmuschaos.io"],"resources":["chaosengines","chaosexperiments","chaosresults"],"verbs":["create","list","get","patch","update","delete"]},{"apiGroups":[""],"resources":["nodes"],"verbs":["get","list","patch"]}]}]}]},"rulename":"exec-into-container-v1"}],"listInputIDs":["rbac.authorization.k8s.io/kube-system/User/system:vpa-recommender/rbac.authorization.k8s.io/v1//ClusterRole/system:controller:horizontal-pod-autoscaler/rbac.authorization.k8s.io/v1//ClusterRoleBinding/system:gke-uas-hpa-controller","/gmp-system/ServiceAccount/operator/rbac.authorization.k8s.io/v1/gmp-system/Role/operator/rbac.authorization.k8s.io/v1/gmp-system/RoleBinding/operator","/kube-system/ServiceAccount/service-account-controller/rbac.authorization.k8s.io/v1//ClusterRole/system:controller:service-account-controller/rbac.authorization.k8s.io/v1//ClusterRoleBinding/system:controller:service-account-controller","rbac.authorization.k8s.io//User/system:slo-monitor/rbac.authorization.k8s.io/v1//ClusterRole/system:slo-monitor/rbac.authorization.k8s.io/v1//ClusterRoleBinding/system:slo-monitor","/kube-system/ServiceAccount/horizontal-pod-autoscaler/rbac.authorization.k8s.io/v1//ClusterRole/system:controller:horizontal-pod-autoscaler/rbac.authorization.k8s.io/v1//ClusterRoleBinding/system:controller:horizontal-pod-autoscaler","/kube-system/ServiceAccount/metrics-server/rbac.authorization.k8s.io/v1//ClusterRole/system:metrics-server/rbac.authorization.k8s.io/v1//ClusterRoleBinding/system:metrics-server","/kube-system/ServiceAccount/generic-garbage-collector/rbac.authorization.k8s.io/v1//ClusterRole/system:controller:generic-garbage-collector/rbac.authorization.k8s.io/v1//ClusterRoleBinding/system:controller:generic-garbage-collector","rbac.authorization.k8s.io//User/system:storageversionmigrator/rbac.authorization.k8s.io/v1//ClusterRole/storage-version-migration-trigger/rbac.authorization.k8s.io/v1//ClusterRoleBinding/storage-version-migration-trigger","/kube-system/ServiceAccount/cronjob-controller/rbac.authorization.k8s.io/v1//ClusterRole/system:controller:cronjob-controller/rbac.authorization.k8s.io/v1//ClusterRoleBinding/system:controller:cronjob-controller","/kube-system/ServiceAccount/metrics-server/rbac.authorization.k8s.io/v1//ClusterRole/system:auth-delegator/rbac.authorization.k8s.io/v1//ClusterRoleBinding/metrics-server:system:auth-delegator","/kube-system/ServiceAccount/ephemeral-volume-controller/rbac.authorization.k8s.io/v1//ClusterRole/system:controller:ephemeral-volume-controller/rbac.authorization.k8s.io/v1//ClusterRoleBinding/system:controller:ephemeral-volume-controller","rbac.authorization.k8s.io//Group/system:authenticated/rbac.authorization.k8s.io/v1//ClusterRole/system:discovery/rbac.authorization.k8s.io/v1//ClusterRoleBinding/system:discovery","/kube-system/ServiceAccount/persistent-volume-binder/rbac.authorization.k8s.io/v1//ClusterRole/system:controller:persistent-volume-binder/rbac.authorization.k8s.io/v1//ClusterRoleBinding/system:controller:persistent-volume-binder","rbac.authorization.k8s.io//Group/system:monitoring/rbac.authorization.k8s.io/v1//ClusterRole/system:monitoring/rbac.authorization.k8s.io/v1//ClusterRoleBinding/system:monitoring","/kube-system/ServiceAccount/endpointslice-controller/rbac.authorization.k8s.io/v1//ClusterRole/system:controller:endpointslice-controller/rbac.authorization.k8s.io/v1//ClusterRoleBinding/system:controller:endpointslice-controller","/kubernetes-dashboard/ServiceAccount/kubernetes-dashboard/rbac.authorization.k8s.io/v1//ClusterRole/kubernetes-dashboard/rbac.authorization.k8s.io/v1//ClusterRoleBinding/kubernetes-dashboard","rbac.authorization.k8s.io//User/kubelet-bootstrap/rbac.authorization.k8s.io/v1//ClusterRole/system:node-bootstrapper/rbac.authorization.k8s.io/v1//ClusterRoleBinding/kubelet-bootstrap-node-bootstrapper","/kube-system/ServiceAccount/cloud-provider/rbac.authorization.k8s.io/v1//ClusterRole/gce:cloud-provider/rbac.authorization.k8s.io/v1//ClusterRoleBinding/gce:cloud-provider","/kube-system/ServiceAccount/kube-dns-autoscaler/rbac.authorization.k8s.io/v1//ClusterRole/system:kube-dns-autoscaler/rbac.authorization.k8s.io/v1//ClusterRoleBinding/system:kube-dns-autoscaler","/kube-system/ServiceAccount/root-ca-cert-publisher/rbac.authorization.k8s.io/v1//ClusterRole/system:controller:root-ca-cert-publisher/rbac.authorization.k8s.io/v1//ClusterRoleBinding/system:controller:root-ca-cert-publisher","/cnf-testsuite/ServiceAccount/falco/rbac.authorization.k8s.io/v1//ClusterRole/falco/rbac.authorization.k8s.io/v1//ClusterRoleBinding/falco","rbac.authorization.k8s.io/kube-system/User/system:vpa-recommender/rbac.authorization.k8s.io/v1//ClusterRole/system:gke-hpa-actor/rbac.authorization.k8s.io/v1//ClusterRoleBinding/system:gke-hpa-actor","rbac.authorization.k8s.io//User/system:storageversionmigrator/rbac.authorization.k8s.io/v1//ClusterRole/storage-version-migration-crd-creator/rbac.authorization.k8s.io/v1//ClusterRoleBinding/storage-version-migration-crd-creator","rbac.authorization.k8s.io//User/kubelet-bootstrap/rbac.authorization.k8s.io/v1//ClusterRole/gce:beta:kubelet-certificate-bootstrap/rbac.authorization.k8s.io/v1//ClusterRoleBinding/kubelet-bootstrap-certificate-bootstrap","rbac.authorization.k8s.io/kube-system/User/system:vpa-recommender/rbac.authorization.k8s.io/v1//ClusterRole/system:gke-uas-collection-reader/rbac.authorization.k8s.io/v1//ClusterRoleBinding/system:gke-uas-collection-reader","rbac.authorization.k8s.io//User/system:snapshot-controller/rbac.authorization.k8s.io/v1//ClusterRole/snapshot-controller-runner/rbac.authorization.k8s.io/v1//ClusterRoleBinding/snapshot-controller-role","rbac.authorization.k8s.io//User/system:pdcsi-controller/rbac.authorization.k8s.io/v1//ClusterRole/pdcsi-resizer-role/rbac.authorization.k8s.io/v1//ClusterRoleBinding/pdcsi-controller-resizer-binding","/kube-system/ServiceAccount/disruption-controller/rbac.authorization.k8s.io/v1//ClusterRole/system:controller:disruption-controller/rbac.authorization.k8s.io/v1//ClusterRoleBinding/system:controller:disruption-controller","rbac.authorization.k8s.io//User/system:kube-scheduler/rbac.authorization.k8s.io/v1//ClusterRole/system:kube-scheduler/rbac.authorization.k8s.io/v1//ClusterRoleBinding/system:kube-scheduler","rbac.authorization.k8s.io//Group/system:nodes/rbac.authorization.k8s.io/v1//ClusterRole/gce:beta:kubelet-certificate-rotation/rbac.authorization.k8s.io/v1//ClusterRoleBinding/gce:beta:kubelet-certificate-rotation","/kube-system/ServiceAccount/pvc-protection-controller/rbac.authorization.k8s.io/v1//ClusterRole/system:controller:pvc-protection-controller/rbac.authorization.k8s.io/v1//ClusterRoleBinding/system:controller:pvc-protection-controller","/kube-system/ServiceAccount/gke-metrics-agent/rbac.authorization.k8s.io/v1//ClusterRole/gke-metrics-agent/rbac.authorization.k8s.io/v1//ClusterRoleBinding/gke-metrics-agent","rbac.authorization.k8s.io//User/system:kube-proxy/rbac.authorization.k8s.io/v1//ClusterRole/system:node-proxier/rbac.authorization.k8s.io/v1//ClusterRoleBinding/system:node-proxier","/gmp-system/ServiceAccount/operator/rbac.authorization.k8s.io/v1/gmp-public/Role/operator/rbac.authorization.k8s.io/v1/gmp-public/RoleBinding/operator","rbac.authorization.k8s.io//User/system:node-problem-detector/rbac.authorization.k8s.io/v1//ClusterRole/system:node-problem-detector/rbac.authorization.k8s.io/v1//ClusterRoleBinding/npd-binding","/kube-system/ServiceAccount/statefulset-controller/rbac.authorization.k8s.io/v1//ClusterRole/system:controller:statefulset-controller/rbac.authorization.k8s.io/v1//ClusterRoleBinding/system:controller:statefulset-controller","rbac.authorization.k8s.io//User/system:storageversionmigrator/rbac.authorization.k8s.io/v1//ClusterRole/cluster-admin/rbac.authorization.k8s.io/v1//ClusterRoleBinding/storage-version-migration-migrator-v2","rbac.authorization.k8s.io//User/system:l7-lb-controller/rbac.authorization.k8s.io/v1//ClusterRole/system:glbc-status/rbac.authorization.k8s.io/v1//ClusterRoleBinding/system:glbc-status","/gmp-system/ServiceAccount/operator/rbac.authorization.k8s.io/v1//ClusterRole/gmp-system:operator/rbac.authorization.k8s.io/v1//ClusterRoleBinding/gmp-system:operator","/kube-system/ServiceAccount/service-controller/rbac.authorization.k8s.io/v1//ClusterRole/system:controller:service-controller/rbac.authorization.k8s.io/v1//ClusterRoleBinding/system:controller:service-controller","rbac.authorization.k8s.io//User/kubelet/rbac.authorization.k8s.io/v1//ClusterRole/system:node-problem-detector/rbac.authorization.k8s.io/v1//ClusterRoleBinding/kubelet-user-npd-binding","/kube-system/ServiceAccount/attachdetach-controller/rbac.authorization.k8s.io/v1//ClusterRole/system:controller:attachdetach-controller/rbac.authorization.k8s.io/v1//ClusterRoleBinding/system:controller:attachdetach-controller","rbac.authorization.k8s.io//User/system:master-prom-to-sd-monitor/rbac.authorization.k8s.io/v1//ClusterRole/system:master-monitoring-role/rbac.authorization.k8s.io/v1//ClusterRoleBinding/master-monitoring-role-binding","rbac.authorization.k8s.io/kube-system/User/system:cluster-autoscaler/rbac.authorization.k8s.io/v1//ClusterRole/ca-cr-actor/rbac.authorization.k8s.io/v1//ClusterRoleBinding/ca-cr","rbac.authorization.k8s.io//User/system:kubestore-collector/rbac.authorization.k8s.io/v1//ClusterRole/system:kubestore-collector/rbac.authorization.k8s.io/v1//ClusterRoleBinding/system:kubestore-collector","/kube-system/ServiceAccount/replication-controller/rbac.authorization.k8s.io/v1//ClusterRole/system:controller:replication-controller/rbac.authorization.k8s.io/v1//ClusterRoleBinding/system:controller:replication-controller","/kube-system/ServiceAccount/resourcequota-controller/rbac.authorization.k8s.io/v1//ClusterRole/system:controller:resourcequota-controller/rbac.authorization.k8s.io/v1//ClusterRoleBinding/system:controller:resourcequota-controller","/kube-system/ServiceAccount/namespace-controller/rbac.authorization.k8s.io/v1//ClusterRole/system:controller:namespace-controller/rbac.authorization.k8s.io/v1//ClusterRoleBinding/system:controller:namespace-controller","rbac.authorization.k8s.io//User/system:gke-common-webhooks/rbac.authorization.k8s.io/v1//ClusterRole/system:gke-common-webhooks/rbac.authorization.k8s.io/v1//ClusterRoleBinding/system:gke-common-webhooks","rbac.authorization.k8s.io//User/system:clustermetrics/rbac.authorization.k8s.io/v1//ClusterRole/system:clustermetrics/rbac.authorization.k8s.io/v1//ClusterRoleBinding/system:clustermetrics","/litmus/ServiceAccount/litmus/rbac.authorization.k8s.io/v1//ClusterRole/litmus/rbac.authorization.k8s.io/v1//ClusterRoleBinding/litmus","/kube-system/ServiceAccount/pv-protection-controller/rbac.authorization.k8s.io/v1//ClusterRole/system:controller:pv-protection-controller/rbac.authorization.k8s.io/v1//ClusterRoleBinding/system:controller:pv-protection-controller","rbac.authorization.k8s.io//User/system:pdcsi-controller/rbac.authorization.k8s.io/v1//ClusterRole/pdcsi-snapshotter-role/rbac.authorization.k8s.io/v1//ClusterRoleBinding/pdcsi-snapshotter-binding","/kube-system/ServiceAccount/konnectivity-agent-cpha/rbac.authorization.k8s.io/v1//ClusterRole/konnectivity-agent-cpha/rbac.authorization.k8s.io/v1//ClusterRoleBinding/konnectivity-agent-cpha","/kube-system/ServiceAccount/deployment-controller/rbac.authorization.k8s.io/v1//ClusterRole/system:controller:deployment-controller/rbac.authorization.k8s.io/v1//ClusterRoleBinding/system:controller:deployment-controller","/kube-system/ServiceAccount/endpointslicemirroring-controller/rbac.authorization.k8s.io/v1//ClusterRole/system:controller:endpointslicemirroring-controller/rbac.authorization.k8s.io/v1//ClusterRoleBinding/system:controller:endpointslicemirroring-controller","rbac.authorization.k8s.io//User/system:resource-tracker/rbac.authorization.k8s.io/v1//ClusterRole/system:resource-tracker/rbac.authorization.k8s.io/v1//ClusterRoleBinding/system:resource-tracker","rbac.authorization.k8s.io//User/system:pdcsi-controller/rbac.authorization.k8s.io/v1//ClusterRole/pdcsi-provisioner-role/rbac.authorization.k8s.io/v1//ClusterRoleBinding/pdcsi-controller-provisioner-binding","/kube-system/ServiceAccount/event-exporter-sa/rbac.authorization.k8s.io/v1//ClusterRole/view/rbac.authorization.k8s.io/v1//ClusterRoleBinding/event-exporter-rb","/kube-system/ServiceAccount/job-controller/rbac.authorization.k8s.io/v1//ClusterRole/system:controller:job-controller/rbac.authorization.k8s.io/v1//ClusterRoleBinding/system:controller:job-controller","rbac.authorization.k8s.io//User/system:managed-certificate-controller/rbac.authorization.k8s.io/v1//ClusterRole/system:managed-certificate-controller/rbac.authorization.k8s.io/v1//ClusterRoleBinding/system:managed-certificate-controller","rbac.authorization.k8s.io//User/system:gke-master-resourcequota/rbac.authorization.k8s.io/v1//ClusterRole/system:gke-master-resourcequota/rbac.authorization.k8s.io/v1//ClusterRoleBinding/system:gke-master-resourcequota","rbac.authorization.k8s.io//User/kubelet/rbac.authorization.k8s.io/v1//ClusterRole/gce:beta:kubelet-certificate-bootstrap/rbac.authorization.k8s.io/v1//ClusterRoleBinding/gce:beta:kubelet-certificate-bootstrap","/kube-system/ServiceAccount/kube-dns/rbac.authorization.k8s.io/v1//ClusterRole/system:kube-dns/rbac.authorization.k8s.io/v1//ClusterRoleBinding/system:kube-dns","rbac.authorization.k8s.io/kube-system/User/system:vpa-recommender/rbac.authorization.k8s.io/v1//ClusterRole/system:gke-hpa-service-reader/rbac.authorization.k8s.io/v1//ClusterRoleBinding/system:gke-hpa-service-reader","rbac.authorization.k8s.io//User/system:kube-scheduler/rbac.authorization.k8s.io/v1//ClusterRole/system:volume-scheduler/rbac.authorization.k8s.io/v1//ClusterRoleBinding/system:volume-scheduler","/kube-system/ServiceAccount/ttl-controller/rbac.authorization.k8s.io/v1//ClusterRole/system:controller:ttl-controller/rbac.authorization.k8s.io/v1//ClusterRoleBinding/system:controller:ttl-controller","rbac.authorization.k8s.io/kube-system/User/system:cluster-autoscaler/rbac.authorization.k8s.io/v1//ClusterRole/cluster-autoscaler/rbac.authorization.k8s.io/v1//ClusterRoleBinding/cluster-autoscaler","rbac.authorization.k8s.io/kube-system/User/system:vpa-recommender/rbac.authorization.k8s.io/v1//ClusterRole/external-metrics-reader/rbac.authorization.k8s.io/v1//ClusterRoleBinding/uas-hpa-external-metrics-reader","/gmp-system/ServiceAccount/operator/rbac.authorization.k8s.io/v1/gmp-public/RoleBinding/operator/rbac.authorization.k8s.io/v1/gmp-system/Role/operator","rbac.authorization.k8s.io//Group/system:serviceaccounts/rbac.authorization.k8s.io/v1//ClusterRole/system:service-account-issuer-discovery/rbac.authorization.k8s.io/v1//ClusterRoleBinding/system:service-account-issuer-discovery","/kube-system/ServiceAccount/node-controller/rbac.authorization.k8s.io/v1//ClusterRole/system:controller:node-controller/rbac.authorization.k8s.io/v1//ClusterRoleBinding/system:controller:node-controller","/kube-system/ServiceAccount/endpoint-controller/rbac.authorization.k8s.io/v1//ClusterRole/system:controller:endpoint-controller/rbac.authorization.k8s.io/v1//ClusterRoleBinding/system:controller:endpoint-controller","rbac.authorization.k8s.io/kube-system/User/system:vpa-recommender/rbac.authorization.k8s.io/v1//ClusterRole/system:gke-uas-metrics-reader/rbac.authorization.k8s.io/v1//ClusterRoleBinding/system:gke-uas-metrics-reader","/gmp-system/ServiceAccount/operator/rbac.authorization.k8s.io/v1/gmp-public/Role/operator/rbac.authorization.k8s.io/v1/gmp-system/RoleBinding/operator","rbac.authorization.k8s.io//Group/system:authenticated/rbac.authorization.k8s.io/v1//ClusterRole/system:basic-user/rbac.authorization.k8s.io/v1//ClusterRoleBinding/system:basic-user","/kube-system/ServiceAccount/kube-proxy/rbac.authorization.k8s.io/v1//ClusterRole/system:node-proxier/rbac.authorization.k8s.io/v1//ClusterRoleBinding/system:kube-proxy","rbac.authorization.k8s.io//User/system:storageversionmigrator/rbac.authorization.k8s.io/v1//ClusterRole/storage-version-migration-initializer/rbac.authorization.k8s.io/v1//ClusterRoleBinding/storage-version-migration-initializer","rbac.authorization.k8s.io//Group/system:masters/rbac.authorization.k8s.io/v1//ClusterRole/cluster-admin/rbac.authorization.k8s.io/v1//ClusterRoleBinding/cluster-admin","/kube-system/ServiceAccount/pod-garbage-collector/rbac.authorization.k8s.io/v1//ClusterRole/system:controller:pod-garbage-collector/rbac.authorization.k8s.io/v1//ClusterRoleBinding/system:controller:pod-garbage-collector","/kube-system/ServiceAccount/clusterrole-aggregation-controller/rbac.authorization.k8s.io/v1//ClusterRole/system:controller:clusterrole-aggregation-controller/rbac.authorization.k8s.io/v1//ClusterRoleBinding/system:controller:clusterrole-aggregation-controller","/kube-system/ServiceAccount/certificate-controller/rbac.authorization.k8s.io/v1//ClusterRole/system:controller:certificate-controller/rbac.authorization.k8s.io/v1//ClusterRoleBinding/system:controller:certificate-controller","rbac.authorization.k8s.io//Group/system:unauthenticated/rbac.authorization.k8s.io/v1//ClusterRole/system:public-info-viewer/rbac.authorization.k8s.io/v1//ClusterRoleBinding/system:public-info-viewer","/kube-system/ServiceAccount/route-controller/rbac.authorization.k8s.io/v1//ClusterRole/system:controller:route-controller/rbac.authorization.k8s.io/v1//ClusterRoleBinding/system:controller:route-controller","rbac.authorization.k8s.io//User/kubelet/rbac.authorization.k8s.io/v1//ClusterRole/system:node-bootstrapper/rbac.authorization.k8s.io/v1//ClusterRoleBinding/kubelet-bootstrap","/kube-system/ServiceAccount/daemon-set-controller/rbac.authorization.k8s.io/v1//ClusterRole/system:controller:daemon-set-controller/rbac.authorization.k8s.io/v1//ClusterRoleBinding/system:controller:daemon-set-controller","/kubernetes-dashboard/ServiceAccount/kubernetes-dashboard/rbac.authorization.k8s.io/v1/kubernetes-dashboard/Role/kubernetes-dashboard/rbac.authorization.k8s.io/v1/kubernetes-dashboard/RoleBinding/kubernetes-dashboard","rbac.authorization.k8s.io//User/system:controller:glbc/rbac.authorization.k8s.io/v1//ClusterRole/system:glbc-status/rbac.authorization.k8s.io/v1//ClusterRoleBinding/system:glbc-status","rbac.authorization.k8s.io//User/system:gcp-controller-manager/rbac.authorization.k8s.io/v1//ClusterRole/system:gcp-controller-manager/rbac.authorization.k8s.io/v1//ClusterRoleBinding/system:gcp-controller-manager","rbac.authorization.k8s.io//User/kube-apiserver/rbac.authorization.k8s.io/v1//ClusterRole/kubelet-api-admin/rbac.authorization.k8s.io/v1//ClusterRoleBinding/kube-apiserver-kubelet-api-admin","rbac.authorization.k8s.io//User/system:pdcsi-controller/rbac.authorization.k8s.io/v1//ClusterRole/pdcsi-attacher-role/rbac.authorization.k8s.io/v1//ClusterRoleBinding/pdcsi-controller-attacher-binding","rbac.authorization.k8s.io//User/system:cloud-controller-manager/rbac.authorization.k8s.io/v1//ClusterRole/system:cloud-controller-manager/rbac.authorization.k8s.io/v1//ClusterRoleBinding/system:cloud-controller-manager","/ark-cnf/ServiceAccount/node-drain-sa/rbac.authorization.k8s.io/v1//ClusterRole/node-drain-sa/rbac.authorization.k8s.io/v1//ClusterRoleBinding/node-drain-sa","/kube-system/ServiceAccount/replicaset-controller/rbac.authorization.k8s.io/v1//ClusterRole/system:controller:replicaset-controller/rbac.authorization.k8s.io/v1//ClusterRoleBinding/system:controller:replicaset-controller","rbac.authorization.k8s.io//Group/system:authenticated/rbac.authorization.k8s.io/v1//ClusterRole/system:public-info-viewer/rbac.authorization.k8s.io/v1//ClusterRoleBinding/system:public-info-viewer","/kube-system/ServiceAccount/expand-controller/rbac.authorization.k8s.io/v1//ClusterRole/system:controller:expand-controller/rbac.authorization.k8s.io/v1//ClusterRoleBinding/system:controller:expand-controller","/kube-system/ServiceAccount/ttl-after-finished-controller/rbac.authorization.k8s.io/v1//ClusterRole/system:controller:ttl-after-finished-controller/rbac.authorization.k8s.io/v1//ClusterRoleBinding/system:controller:ttl-after-finished-controller","rbac.authorization.k8s.io/kube-system/User/system:vpa-recommender/rbac.authorization.k8s.io/v1//ClusterRole/system:gke-controller/rbac.authorization.k8s.io/v1//ClusterRoleBinding/system:gke-controller","/gmp-system/ServiceAccount/collector/rbac.authorization.k8s.io/v1//ClusterRole/gmp-system:collector/rbac.authorization.k8s.io/v1//ClusterRoleBinding/gmp-system:collector","rbac.authorization.k8s.io//User/cluster-autoscaler/rbac.authorization.k8s.io/v1//ClusterRole/read-updateinfo/rbac.authorization.k8s.io/v1//ClusterRoleBinding/cluster-autoscaler-updateinfo","rbac.authorization.k8s.io//User/system:konnectivity-server/rbac.authorization.k8s.io/v1//ClusterRole/system:auth-delegator/rbac.authorization.k8s.io/v1//ClusterRoleBinding/system:konnectivity-server","rbac.authorization.k8s.io//User/system:kube-controller-manager/rbac.authorization.k8s.io/v1//ClusterRole/system:kube-controller-manager/rbac.authorization.k8s.io/v1//ClusterRoleBinding/system:kube-controller-manager"],"totalResources":102,"failedResources":1,"warningResources":2}],"remediation":"It is recommended to prohibit “kubectl exec” command in production environments. It is also recommended not to use subjects with this permission for daily cluster operations.","description":"Attackers with relevant permissions can run malicious commands in the context of legitimate containers in the cluster using “kubectl exec” command. This control determines which subjects have permissions to use this command.","score":0.98039216,"baseScore":5,"totalResources":102,"failedResources":1,"warningResources":2},{"guid":"","id":"C-0044","controlID":"C-0044","name":"Container hostPort","ruleReports":[{"name":"container-hostPort","remediation":"","ruleStatus":{"status":"success","message":""},"ruleResponses":null,"listInputIDs":["apps/v1/gmp-system/DaemonSet/collector","apps/v1/gmp-system/Deployment/gmp-operator","apps/v1/ark-cnf/Deployment/arklb","apps/v1/gmp-system/Deployment/rule-evaluator","apps/v1/kubernetes-dashboard/Deployment/dashboard-metrics-scraper","apps/v1/kubernetes-dashboard/Deployment/kubernetes-dashboard","apps/v1/gmp-system/StatefulSet/alertmanager"],"totalResources":7,"failedResources":0,"warningResources":0}],"remediation":"Avoid usage of hostPort unless it is absolutely necessary, in which case define appropriate exception. Use NodePort / ClusterIP instead.","description":"Configuring hostPort requires a particular port number. If two objects specify the same HostPort, they could not be deployed to the same node. It may prevent the second object from starting, even if Kubernetes will try reschedule it on another node, provided there are available nodes with sufficient amount of resources. Also, if the number of replicas of such workload is higher than the number of nodes, the deployment will consistently fail.","score":0,"baseScore":4,"totalResources":7,"failedResources":0,"warningResources":0},{"guid":"","id":"C-0054","controlID":"C-0054","name":"Cluster internal networking","ruleReports":[{"name":"internal-networking","remediation":"","ruleStatus":{"status":"success","message":""},"ruleResponses":[{"alertMessage":"","failedPaths":null,"fixPaths":null,"ruleStatus":"excluded","packagename":"","alertScore":0,"alertObject":{"k8sApiObjects":[{"apiVersion":"v1","kind":"Namespace","metadata":{"creationTimestamp":"2023-05-24T16:39:22Z","labels":{"kubernetes.io/metadata.name":"default"},"name":"default","resourceVersion":"190","uid":"c395dc2d-93ff-47d6-9ebf-212d916fc7b4"}}]},"rulename":"internal-networking","exception":{"guid":"","name":"exclude-default-namespace-resources-2","attributes":{"systemException":true},"policyType":"postureExceptionPolicy","creationTime":"","actions":["alertOnly"],"resources":[{"designatorType":"Attributes","attributes":{"kind":"Namespace","name":"default"}}],"posturePolicies":[{"frameworkName":""}]}},{"alertMessage":"","failedPaths":null,"fixPaths":null,"ruleStatus":"failed","packagename":"","alertScore":0,"alertObject":{"k8sApiObjects":[{"apiVersion":"v1","kind":"Namespace","metadata":{"annotations":{"components.gke.io/layer":"addon"},"creationTimestamp":"2023-05-25T09:54:01Z","labels":{"addonmanager.kubernetes.io/mode":"Reconcile","kubernetes.io/metadata.name":"gmp-public"},"name":"gmp-public","resourceVersion":"605802","uid":"bcc6c4d5-fb1e-4829-864f-f747b4b30355"}}]},"rulename":"internal-networking"},{"alertMessage":"","failedPaths":null,"fixPaths":null,"ruleStatus":"failed","packagename":"","alertScore":0,"alertObject":{"k8sApiObjects":[{"apiVersion":"v1","kind":"Namespace","metadata":{"annotations":{"components.gke.io/layer":"addon"},"creationTimestamp":"2023-05-25T09:54:01Z","labels":{"addonmanager.kubernetes.io/mode":"Reconcile","kubernetes.io/metadata.name":"gmp-system"},"name":"gmp-system","resourceVersion":"605793","uid":"1e3a3a20-d960-4f22-b1be-33bb66f41ecb"}}]},"rulename":"internal-networking"},{"alertMessage":"","failedPaths":null,"fixPaths":null,"ruleStatus":"failed","packagename":"","alertScore":0,"alertObject":{"k8sApiObjects":[{"apiVersion":"v1","kind":"Namespace","metadata":{"creationTimestamp":"2023-05-27T11:27:52Z","labels":{"kubernetes.io/metadata.name":"ark-cnf"},"name":"ark-cnf","resourceVersion":"2239795","uid":"123a9ca4-0607-4ec6-8c60-5f385c2c8bc7"}}]},"rulename":"internal-networking"},{"alertMessage":"","failedPaths":null,"fixPaths":null,"ruleStatus":"failed","packagename":"","alertScore":0,"alertObject":{"k8sApiObjects":[{"apiVersion":"v1","kind":"Namespace","metadata":{"annotations":{},"creationTimestamp":"2023-05-26T15:05:41Z","labels":{"kubernetes.io/metadata.name":"kubernetes-dashboard"},"name":"kubernetes-dashboard","resourceVersion":"1615368","uid":"53fe2f98-4626-447a-a46f-58b04eba73d8"}}]},"rulename":"internal-networking"}],"listInputIDs":["/v1//Namespace/default","/v1//Namespace/gmp-public","/v1//Namespace/gmp-system","/v1//Namespace/ark-cnf","/v1//Namespace/kubernetes-dashboard"],"totalResources":5,"failedResources":4,"warningResources":1}],"remediation":"Define Kubernetes network policies or use alternative products to protect cluster network.","description":"If no network policy is defined, attackers who gain access to a container may use it to move laterally in the cluster. This control lists namespaces in which no network policy is defined.","score":80,"baseScore":4,"totalResources":5,"failedResources":4,"warningResources":1},{"guid":"","id":"C-0005","controlID":"C-0005","name":"Control plane hardening","ruleReports":[],"remediation":"Set the insecure-port flag of the API server to zero.","description":"Kubernetes control plane API is running with non-secure port enabled which allows attackers to gain unprotected access to the cluster.","score":0,"baseScore":8,"totalResources":0,"failedResources":0,"warningResources":0},{"guid":"","id":"C-0012","controlID":"C-0012","name":"Applications credentials in configuration files","ruleReports":[{"name":"rule-credentials-in-env-var","remediation":"","ruleStatus":{"status":"success","message":""},"ruleResponses":null,"listInputIDs":["apps/v1/ark-cnf/Deployment/arklb","apps/v1/gmp-system/DaemonSet/collector","apps/v1/gmp-system/Deployment/rule-evaluator","apps/v1/kubernetes-dashboard/Deployment/kubernetes-dashboard","apps/v1/gmp-system/Deployment/gmp-operator","apps/v1/kubernetes-dashboard/Deployment/dashboard-metrics-scraper","apps/v1/gmp-system/StatefulSet/alertmanager"],"totalResources":7,"failedResources":0,"warningResources":0},{"name":"rule-credentials-configmap","remediation":"","ruleStatus":{"status":"success","message":""},"ruleResponses":null,"listInputIDs":["/v1/default/ConfigMap/kube-root-ca.crt","/v1/gmp-system/ConfigMap/collector","/v1/gmp-public/ConfigMap/kube-root-ca.crt","/v1/kubernetes-dashboard/ConfigMap/kube-root-ca.crt","/v1/default/ConfigMap/cnf-testsuite-arklb-startup-information","/v1/gmp-system/ConfigMap/config-images","/v1/gmp-system/ConfigMap/kube-root-ca.crt","/v1/gmp-system/ConfigMap/rule-evaluator","/v1/gmp-system/ConfigMap/rules-generated","/v1/ark-cnf/ConfigMap/kube-root-ca.crt","/v1/kubernetes-dashboard/ConfigMap/kubernetes-dashboard-settings"],"totalResources":11,"failedResources":0,"warningResources":0}],"remediation":"Use Kubernetes secrets or Key Management Systems to store credentials.","description":"Attackers who have access to configuration files can steal the stored secrets and use them. This control checks if ConfigMaps or pod specifications have sensitive information in their configuration.","score":0,"baseScore":8,"totalResources":18,"failedResources":0,"warningResources":0},{"guid":"","id":"C-0046","controlID":"C-0046","name":"Insecure capabilities","ruleReports":[{"name":"insecure-capabilities","remediation":"","ruleStatus":{"status":"success","message":""},"ruleResponses":null,"listInputIDs":["apps/v1/ark-cnf/Deployment/arklb","apps/v1/gmp-system/Deployment/rule-evaluator","apps/v1/kubernetes-dashboard/Deployment/kubernetes-dashboard","apps/v1/gmp-system/Deployment/gmp-operator","apps/v1/gmp-system/StatefulSet/alertmanager","apps/v1/gmp-system/DaemonSet/collector","apps/v1/kubernetes-dashboard/Deployment/dashboard-metrics-scraper"],"totalResources":7,"failedResources":0,"warningResources":0}],"remediation":"Remove all insecure capabilities which aren’t necessary for the container.","description":"Giving insecure or excsessive capabilities to a container can increase the impact of the container compromise. This control identifies all the PODs with dangerous capabilities (see documentation pages for details).","score":0,"baseScore":5,"totalResources":7,"failedResources":0,"warningResources":0},{"guid":"","id":"C-0055","controlID":"C-0055","name":"Linux hardening","ruleReports":[{"name":"linux-hardening","remediation":"","ruleStatus":{"status":"success","message":""},"ruleResponses":[{"alertMessage":"","failedPaths":null,"fixPaths":[{"path":"spec.template.spec.containers[0].seccompProfile","value":"YOUR_VALUE"},{"path":"spec.template.spec.containers[0].seLinuxOptions","value":"YOUR_VALUE"},{"path":"spec.template.spec.containers[0].capabilities.drop","value":"YOUR_VALUE"}],"ruleStatus":"failed","packagename":"","alertScore":0,"alertObject":{"k8sApiObjects":[{"apiVersion":"apps/v1","kind":"Deployment","metadata":{"annotations":{"deployment.kubernetes.io/revision":"3","litmuschaos.io/chaos":"true","meta.helm.sh/release-name":"arklb","meta.helm.sh/release-namespace":"ark-cnf"},"creationTimestamp":"2023-05-27T11:58:34Z","generation":8,"labels":{"app.kubernetes.io/instance":"arklb","app.kubernetes.io/managed-by":"Helm","app.kubernetes.io/name":"arklb","app.kubernetes.io/version":"v0.1.10","helm.sh/chart":"arklb-0.1.11"},"name":"arklb","namespace":"ark-cnf","resourceVersion":"2260893","uid":"cc4b4ff4-8e89-475f-beb8-0a715c1fcac1"}}]},"rulename":"linux-hardening"}],"listInputIDs":["apps/v1/gmp-system/Deployment/gmp-operator","apps/v1/kubernetes-dashboard/Deployment/dashboard-metrics-scraper","apps/v1/gmp-system/StatefulSet/alertmanager","apps/v1/gmp-system/DaemonSet/collector","apps/v1/kubernetes-dashboard/Deployment/kubernetes-dashboard","apps/v1/ark-cnf/Deployment/arklb","apps/v1/gmp-system/Deployment/rule-evaluator"],"totalResources":7,"failedResources":1,"warningResources":0}],"remediation":"You can use AppArmor, Seccomp, SELinux and Linux Capabilities mechanisms to restrict containers abilities to utilize unwanted privileges.","description":"Containers may be given more privileges than they actually need. This can increase the potential impact of a container compromise.","score":14.285714,"baseScore":4,"totalResources":7,"failedResources":1,"warningResources":0},{"guid":"","id":"C-0067","controlID":"C-0067","name":"Audit logs enabled","ruleReports":[],"remediation":"Turn on audit logging for your cluster. Look at the vendor guidelines for more details","description":"Audit logging is an important security feature in Kubernetes, it enables the operator to track requests to the cluster. It is important to use it so the operator has a record of events happened in Kubernetes","score":0,"baseScore":3,"totalResources":0,"failedResources":0,"warningResources":0}],"score":9.824561,"totalResources":135,"failedResources":21,"warningResources":4}